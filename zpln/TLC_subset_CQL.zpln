{"paragraphs":[{"text":"%spark\r\n// Import packages.\r\nimport spark.implicits._\r\nimport org.apache.spark.sql.types._\r\nimport org.apache.spark.sql.expressions._\r\nimport org.apache.spark.sql.functions._","user":"anonymous","dateUpdated":"2025-10-20T12:32:21+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.expressions._\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094318_343515361","id":"paragraph_1760632159798_1954866381","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:21+0000","dateFinished":"2025-10-20T12:32:25+0000","status":"FINISHED","focus":false},{"text":"%spark\r\n// Import of TCL data:\r\n\r\n// Define Schema for TCL.\r\nval refPath = \"/sparkio/TLC/trips/2025/yellow_tripdata_2025-01.parquet\"\r\nval refSchema = spark.read.parquet(refPath).schema\r\n\r\n// Define path for datafiles.\r\n\r\nval base = (\"/sparkio/TLC/trips/2025/yellow_tripdata_2025-01.parquet\")\r\n\r\n// Load data into a DataFrame.\r\nval df = spark.read\r\n\t.option(\"recursiveFileLookup\", false)\r\n\t.schema(refSchema)\r\n\t.parquet(base)\r\n\r\n// Validate results.\r\nprint(\"Yellow df\\n\")\r\ndf.show(3, truncate = false)\r\n\r\n","user":"anonymous","dateUpdated":"2025-10-20T12:32:22+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Yellow df\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+\n|VendorID|tpep_pickup_datetime|tpep_dropoff_datetime|passenger_count|trip_distance|RatecodeID|store_and_fwd_flag|PULocationID|DOLocationID|payment_type|fare_amount|extra|mta_tax|tip_amount|tolls_amount|improvement_surcharge|total_amount|congestion_surcharge|Airport_fee|cbd_congestion_fee|\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+\n|1       |2025-01-01 00:18:38 |2025-01-01 00:26:59  |1              |1.6          |1         |N                 |229         |237         |1           |10.0       |3.5  |0.5    |3.0       |0.0         |1.0                  |18.0        |2.5                 |0.0        |0.0               |\n|1       |2025-01-01 00:32:40 |2025-01-01 00:35:13  |1              |0.5          |1         |N                 |236         |237         |1           |5.1        |3.5  |0.5    |2.02      |0.0         |1.0                  |12.12       |2.5                 |0.0        |0.0               |\n|1       |2025-01-01 00:44:04 |2025-01-01 00:46:01  |1              |0.6          |1         |N                 |141         |141         |1           |5.1        |3.5  |0.5    |2.0       |0.0         |1.0                  |12.1        |2.5                 |0.0        |0.0               |\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+\nonly showing top 3 rows\n\n\u001b[1m\u001b[34mrefPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /sparkio/TLC/trips/2025/yellow_tripdata_2025-01.parquet\n\u001b[1m\u001b[34mrefSchema\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.types.StructType\u001b[0m = StructType(StructField(VendorID,IntegerType,true),StructField(tpep_pickup_datetime,TimestampNTZType,true),StructField(tpep_dropoff_datetime,TimestampNTZType,true),StructField(passenger_count,LongType,true),StructField(trip_distance,DoubleType,true),StructField(RatecodeID,LongType,true),StructField(store_and_fwd_flag,StringType,true),StructField(PULocationID,IntegerType,true),StructField(DOLocationID,IntegerType,true),StructField(payment_type,LongType,true),StructField(fare_amount,DoubleType,true),StructField(extra,DoubleType,true),StructField(mta_tax,DoubleType,true),StructField(tip_amount,DoubleType,true),Struct...\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=12"},{"jobUrl":"http://localhost:4040/jobs/job?id=13"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094321_1248195820","id":"paragraph_1760632200176_52696574","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:25+0000","dateFinished":"2025-10-20T12:32:30+0000","status":"FINISHED"},{"text":"%spark\n// Build trip_duration_min, hour_of_day, day_of_week.\nval dfWithSpeed =\n  df\n    .withColumn(\"pickup_day\", col(\"tpep_pickup_datetime\").cast(\"timestamp\"))\n    .withColumn(\"dropoff_day\", col(\"tpep_dropoff_datetime\").cast(\"timestamp\"))\n    .withColumn(\"pickup_sec\",  col(\"tpep_pickup_datetime\").cast(\"timestamp\").cast(\"long\"))\n    .withColumn(\"dropoff_sec\", col(\"tpep_dropoff_datetime\").cast(\"timestamp\").cast(\"long\"))\n    // duration in hours.\n    .withColumn(\"duration_hours\",\n      (col(\"dropoff_sec\") - col(\"pickup_sec\")) / 3600.0\n    )\n    // speed = miles / hours.\n    .withColumn(\n      \"Speed_miles_pr_hour\",\n      when(col(\"duration_hours\") > 0,\n           col(\"trip_distance\") / col(\"duration_hours\")\n      ).otherwise(lit(null).cast(\"double\"))\n    )\n    // Travel duration in minutes.\n    .withColumn(\n        \"trip_duration_min\",\n        when(not(col(\"duration_hours\").isNull),\n            col(\"duration_hours\") * 60\n        ).otherwise(lit(null).cast(\"double\"))\n    )\n    .drop(\"pickup_sec\",\"dropoff_sec\",\"duration_hours\")\n    .withColumn(\"Speed_miles_pr_hour\", round(col(\"Speed_miles_pr_hour\"), 2))\n    .withColumn(\"trip_duration_min\", round(col(\"trip_duration_min\"), 2))\n    .withColumn(\"hour_of_day\", date_format(col(\"pickup_day\"), \"k\"))\n    .withColumn(\"pickup_day\", dayofweek(col(\"pickup_day\")))\n    .withColumn(\"dropoff_day\", dayofweek(col(\"dropoff_day\")))","user":"anonymous","dateUpdated":"2025-10-20T12:32:24+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mdfWithSpeed\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 23 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094322_1468245223","id":"paragraph_1760632750389_279968743","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:30+0000","dateFinished":"2025-10-20T12:32:32+0000","status":"FINISHED"},{"text":"%spark\n// Creating a new df excluding rows where speed > 80 or speed == NULL.\nval dfWithSpeedRmHighSpeedAndNull = dfWithSpeed.filter(col(\"Speed_miles_pr_hour\") <= 80)","user":"anonymous","dateUpdated":"2025-10-20T12:32:26+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mdfWithSpeedRmHighSpeedAndNull\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 23 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094323_30145831","id":"paragraph_1760632793308_408933411","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:32+0000","dateFinished":"2025-10-20T12:32:33+0000","status":"FINISHED"},{"text":"%spark\nval df = dfWithSpeedRmHighSpeedAndNull","user":"anonymous","dateUpdated":"2025-10-20T12:32:28+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 23 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094324_1772118345","id":"paragraph_1760632844388_422188620","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:33+0000","dateFinished":"2025-10-20T12:32:34+0000","status":"FINISHED"},{"text":"%spark\n// Create new df excluding rows where total_amount is 0 or lower.\nval PositiveFare = df.filter(col(\"total_amount\") > 0)","user":"anonymous","dateUpdated":"2025-10-20T12:32:30+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mPositiveFare\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 23 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094324_1940147601","id":"paragraph_1760632867351_1597892318","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:34+0000","dateFinished":"2025-10-20T12:32:34+0000","status":"FINISHED"},{"text":"%spark\nval df = PositiveFare","user":"anonymous","dateUpdated":"2025-10-20T12:32:32+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 23 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094325_594660945","id":"paragraph_1760632906948_277535764","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:34+0000","dateFinished":"2025-10-20T12:32:35+0000","status":"FINISHED"},{"text":"%spark\n// New df excluding rows where number of passanger are 0 or lower.\nval passengerMoreThanZero = df.filter(col(\"passenger_count\") > 0)","user":"anonymous","dateUpdated":"2025-10-20T12:32:36+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mpassengerMoreThanZero\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 23 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094326_829200226","id":"paragraph_1760632918749_1932152998","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:36+0000","dateFinished":"2025-10-20T12:32:37+0000","status":"FINISHED"},{"text":"%spark\n// Make df excluding 0 or less passangers the new main df.\nval df = passengerMoreThanZero","user":"anonymous","dateUpdated":"2025-10-20T12:32:38+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 23 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094326_2110354254","id":"paragraph_1760632935875_1234654767","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:38+0000","dateFinished":"2025-10-20T12:32:39+0000","status":"FINISHED"},{"text":"%spark\ndf.printSchema()","user":"anonymous","dateUpdated":"2025-10-20T12:32:41+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- VendorID: integer (nullable = true)\n |-- tpep_pickup_datetime: timestamp_ntz (nullable = true)\n |-- tpep_dropoff_datetime: timestamp_ntz (nullable = true)\n |-- passenger_count: long (nullable = true)\n |-- trip_distance: double (nullable = true)\n |-- RatecodeID: long (nullable = true)\n |-- store_and_fwd_flag: string (nullable = true)\n |-- PULocationID: integer (nullable = true)\n |-- DOLocationID: integer (nullable = true)\n |-- payment_type: long (nullable = true)\n |-- fare_amount: double (nullable = true)\n |-- extra: double (nullable = true)\n |-- mta_tax: double (nullable = true)\n |-- tip_amount: double (nullable = true)\n |-- tolls_amount: double (nullable = true)\n |-- improvement_surcharge: double (nullable = true)\n |-- total_amount: double (nullable = true)\n |-- congestion_surcharge: double (nullable = true)\n |-- Airport_fee: double (nullable = true)\n |-- cbd_congestion_fee: double (nullable = true)\n |-- pickup_day: integer (nullable = true)\n |-- dropoff_day: integer (nullable = true)\n |-- Speed_miles_pr_hour: double (nullable = true)\n |-- trip_duration_min: double (nullable = true)\n |-- hour_of_day: string (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094327_1544638149","id":"paragraph_1760632948555_884641831","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:41+0000","dateFinished":"2025-10-20T12:32:42+0000","status":"FINISHED"},{"text":"%spark\n// Import of MapZone data:\n\n//File location.\nval base = (\"/sparkio/TLC/mapZones/taxi_zone_lookup.csv\")\n\n// Custom schema (LocationID got defined as a string without).\nval zoneSchema = StructType(Array(\n    StructField(\"LocationID\", IntegerType, true),\n    StructField(\"Borough\", StringType, true),\n    StructField(\"Zone\", StringType, true),\n    StructField(\"service_zone\", StringType, true)\n))\n\n// Import of data to df.\nval dfZone = spark.read\n\t.option(\"header\", \"true\")\n    .schema(zoneSchema)\n    .csv(base)\n\n// Validating content of new df.\ndfZone.show(3, truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T12:32:44+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-------+-----------------------+------------+\n|LocationID|Borough|Zone                   |service_zone|\n+----------+-------+-----------------------+------------+\n|1         |EWR    |Newark Airport         |EWR         |\n|2         |Queens |Jamaica Bay            |Boro Zone   |\n|3         |Bronx  |Allerton/Pelham Gardens|Boro Zone   |\n+----------+-------+-----------------------+------------+\nonly showing top 3 rows\n\n\u001b[1m\u001b[34mbase\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /sparkio/TLC/mapZones/taxi_zone_lookup.csv\n\u001b[1m\u001b[34mzoneSchema\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.types.StructType\u001b[0m = StructType(StructField(LocationID,IntegerType,true),StructField(Borough,StringType,true),StructField(Zone,StringType,true),StructField(service_zone,StringType,true))\n\u001b[1m\u001b[34mdfZone\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [LocationID: int, Borough: string ... 2 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=14"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094328_681190616","id":"paragraph_1760633205138_882402655","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:44+0000","dateFinished":"2025-10-20T12:32:47+0000","status":"FINISHED"},{"text":"%spark\n// Create new df to contain location names corresponding with locationIDs.\n// Two left joins to add pickup and dropoff location names.\nval dfWithLocationNames =\n  df.alias(\"m\")\n    .join(dfZone.alias(\"zpu\"),\n        col(\"m.PULocationID\") === col(\"zpu.LocationID\"),\n        \"left\")\n    .join(dfZone.alias(\"zdo\"),\n        col(\"m.DOLocationID\") === col (\"zdo.LocationID\"),\n        \"left\")\n    .select(col(\"m.*\"),\n        col(\"zpu.Zone\").as(\"pickup_location_name\"),\n        col(\"zpu.Borough\").as(\"PU_Borough\"),\n        col(\"zdo.Zone\").as(\"dropoff_location_name\"),\n        col(\"zdo.Borough\").as(\"DO_Borough\"))\n\n// Validate content of new df.\ndfWithLocationNames.show(3, truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T12:32:48+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\n|VendorID|tpep_pickup_datetime|tpep_dropoff_datetime|passenger_count|trip_distance|RatecodeID|store_and_fwd_flag|PULocationID|DOLocationID|payment_type|fare_amount|extra|mta_tax|tip_amount|tolls_amount|improvement_surcharge|total_amount|congestion_surcharge|Airport_fee|cbd_congestion_fee|pickup_day|dropoff_day|Speed_miles_pr_hour|trip_duration_min|hour_of_day|pickup_location_name         |PU_Borough|dropoff_location_name|DO_Borough|\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\n|1       |2025-01-01 00:18:38 |2025-01-01 00:26:59  |1              |1.6          |1         |N                 |229         |237         |1           |10.0       |3.5  |0.5    |3.0       |0.0         |1.0                  |18.0        |2.5                 |0.0        |0.0               |4         |4          |11.5               |8.35             |24         |Sutton Place/Turtle Bay North|Manhattan |Upper East Side South|Manhattan |\n|1       |2025-01-01 00:32:40 |2025-01-01 00:35:13  |1              |0.5          |1         |N                 |236         |237         |1           |5.1        |3.5  |0.5    |2.02      |0.0         |1.0                  |12.12       |2.5                 |0.0        |0.0               |4         |4          |11.76              |2.55             |24         |Upper East Side North        |Manhattan |Upper East Side South|Manhattan |\n|1       |2025-01-01 00:44:04 |2025-01-01 00:46:01  |1              |0.6          |1         |N                 |141         |141         |1           |5.1        |3.5  |0.5    |2.0       |0.0         |1.0                  |12.1        |2.5                 |0.0        |0.0               |4         |4          |18.46              |1.95             |24         |Lenox Hill West              |Manhattan |Lenox Hill West      |Manhattan |\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\nonly showing top 3 rows\n\n\u001b[1m\u001b[34mdfWithLocationNames\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 27 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=15"},{"jobUrl":"http://localhost:4040/jobs/job?id=16"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094329_556566283","id":"paragraph_1760633209161_1984908886","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:48+0000","dateFinished":"2025-10-20T12:32:52+0000","status":"FINISHED"},{"text":"%spark\n// Make df with location names included the new main df.\nval df = dfWithLocationNames\n\n// Validate content of new main df.\ndf.show(3, truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T12:32:51+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\n|VendorID|tpep_pickup_datetime|tpep_dropoff_datetime|passenger_count|trip_distance|RatecodeID|store_and_fwd_flag|PULocationID|DOLocationID|payment_type|fare_amount|extra|mta_tax|tip_amount|tolls_amount|improvement_surcharge|total_amount|congestion_surcharge|Airport_fee|cbd_congestion_fee|pickup_day|dropoff_day|Speed_miles_pr_hour|trip_duration_min|hour_of_day|pickup_location_name         |PU_Borough|dropoff_location_name|DO_Borough|\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\n|1       |2025-01-01 00:18:38 |2025-01-01 00:26:59  |1              |1.6          |1         |N                 |229         |237         |1           |10.0       |3.5  |0.5    |3.0       |0.0         |1.0                  |18.0        |2.5                 |0.0        |0.0               |4         |4          |11.5               |8.35             |24         |Sutton Place/Turtle Bay North|Manhattan |Upper East Side South|Manhattan |\n|1       |2025-01-01 00:32:40 |2025-01-01 00:35:13  |1              |0.5          |1         |N                 |236         |237         |1           |5.1        |3.5  |0.5    |2.02      |0.0         |1.0                  |12.12       |2.5                 |0.0        |0.0               |4         |4          |11.76              |2.55             |24         |Upper East Side North        |Manhattan |Upper East Side South|Manhattan |\n|1       |2025-01-01 00:44:04 |2025-01-01 00:46:01  |1              |0.6          |1         |N                 |141         |141         |1           |5.1        |3.5  |0.5    |2.0       |0.0         |1.0                  |12.1        |2.5                 |0.0        |0.0               |4         |4          |18.46              |1.95             |24         |Lenox Hill West              |Manhattan |Lenox Hill West      |Manhattan |\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\nonly showing top 3 rows\n\n\u001b[1m\u001b[34mdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 27 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=17"},{"jobUrl":"http://localhost:4040/jobs/job?id=18"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094329_1444940611","id":"paragraph_1760633270716_806223658","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:52+0000","dateFinished":"2025-10-20T12:32:55+0000","status":"FINISHED"},{"text":"%spark\n// Validate schema on new main df.\ndf.printSchema()","user":"anonymous","dateUpdated":"2025-10-20T12:32:54+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- VendorID: integer (nullable = true)\n |-- tpep_pickup_datetime: timestamp_ntz (nullable = true)\n |-- tpep_dropoff_datetime: timestamp_ntz (nullable = true)\n |-- passenger_count: long (nullable = true)\n |-- trip_distance: double (nullable = true)\n |-- RatecodeID: long (nullable = true)\n |-- store_and_fwd_flag: string (nullable = true)\n |-- PULocationID: integer (nullable = true)\n |-- DOLocationID: integer (nullable = true)\n |-- payment_type: long (nullable = true)\n |-- fare_amount: double (nullable = true)\n |-- extra: double (nullable = true)\n |-- mta_tax: double (nullable = true)\n |-- tip_amount: double (nullable = true)\n |-- tolls_amount: double (nullable = true)\n |-- improvement_surcharge: double (nullable = true)\n |-- total_amount: double (nullable = true)\n |-- congestion_surcharge: double (nullable = true)\n |-- Airport_fee: double (nullable = true)\n |-- cbd_congestion_fee: double (nullable = true)\n |-- pickup_day: integer (nullable = true)\n |-- dropoff_day: integer (nullable = true)\n |-- Speed_miles_pr_hour: double (nullable = true)\n |-- trip_duration_min: double (nullable = true)\n |-- hour_of_day: string (nullable = true)\n |-- pickup_location_name: string (nullable = true)\n |-- PU_Borough: string (nullable = true)\n |-- dropoff_location_name: string (nullable = true)\n |-- DO_Borough: string (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094330_394477978","id":"paragraph_1760633296027_67560484","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:32:56+0000","dateFinished":"2025-10-20T12:32:57+0000","status":"FINISHED"},{"text":"%cassandra\nSELECT keyspace_name FROM system_schema.keyspaces;\n","user":"anonymous","dateUpdated":"2025-10-20T12:33:01+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"keyspace_name\nsystem_auth\nsystem_schema\nsystem_distributed\nsystem\nsystem_traces\nmock_tlc_ks\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094330_797738748","id":"paragraph_1760634369630_1573456806","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:33:01+0000","dateFinished":"2025-10-20T12:33:01+0000","status":"FINISHED"},{"text":"%cassandra\nCREATE KEYSPACE tlc_ks\nWITH REPLICATION = {\n  'class': 'SimpleStrategy',\n  'replication_factor': 1\n};\n","user":"anonymous","dateUpdated":"2025-10-20T12:33:18+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n\n\n\n\n<div class=\"container\">\n<div class=\"row\">\n  <h5>No Result &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n    <a role=\"button\" data-toggle=\"collapse\" data-target=\"#810b5ee2-c538-4613-be2a-d5755425122a\" aria-expanded=\"false\">\n      <span class=\"text-info\"><strong>Last query execution info</strong></span>\n    </a>\n  </h5>\n</div>\n<div class=\"panel panel-default\">\n  <div id=\"810b5ee2-c538-4613-be2a-d5755425122a\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n    <div class=\"panel-body\">\n      <div class=\"row\">\n        <div class=\"col-md-3\"></div>\n        <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th>Information</th>\n                <th style=\"text-align:left\">Value</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td>Statement</td>\n                <td style=\"text-align:left\">CREATE KEYSPACE tlc_ks\nWITH REPLICATION = {\n  'class': 'SimpleStrategy',\n  'replication_factor': 1\n};</td>\n              </tr>\n              <tr>\n                <td>Tried Hosts</td>\n                <td style=\"text-align:left\">cassandra-seed:9042</td>\n              </tr>\n              <tr>\n                <td>Queried Hosts</td>\n                <td style=\"text-align:left\">cassandra-seed:9042</td>\n              </tr>\n              <tr>\n                <td>Schema in Agreement</td>\n                <td style=\"text-align:left\">true</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094331_1705332802","id":"paragraph_1760633320645_519593557","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:33:18+0000","dateFinished":"2025-10-20T12:33:21+0000","status":"FINISHED"},{"text":"%cassandra\nDESCRIBE KEYSPACE tlc_ks;","user":"anonymous","dateUpdated":"2025-10-20T12:34:50+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<br/>\n<br/>\n<nav class=\"navbar navbar-default\">\n    <ul class=\"nav navbar-nav\">\n        \n\n<li role=\"presentation\" class=\"dropdown\">\n    <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <span class=\"text-danger\"><span class=\"glyphicon glyphicon-folder-open\"></span>&nbsp;&nbsp;<strong>tlc_ks</strong></span>\n        <span class=\"text-danger caret\"></span>\n        <ul class=\"dropdown-menu\">\n            \n\n            <li class=\"dropdown-header\"><span class=\"text-primary\">Tables</span></li>\n                            <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#2bb69cd0-adb1-11f0-8e48-0b293a0e2b08\">\n                    <span class=\"text-primary\"><span class=\"glyphicon glyphicon-th-list\"></span>&nbsp;tlc_raw</span>\n                </a>\n            </li>\n                            \n            \n            \n            \n                    </ul>\n    </a>\n</li>\n        <li>\n            <a><strong>DESCRIBE KEYSPACE tlc_ks;</strong></a>\n        </li>\n    </ul>\n    <ul class=\"nav navbar-nav navbar-right\">\n        <li class=\"dropdown\">\n            <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <strong>Legend</strong>\n                <span class=\"caret\"></span>\n            </a>\n            <ul class=\"dropdown-menu\">\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-dashboard text-muted\" aria-hidden=\"true\" ></span>&nbsp;Cluster\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-folder-open text-danger\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Keyspace\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-copyright-mark text-warning\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;UDT\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-th-list text-primary\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Table\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-eye-open text-primary\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Materialized View\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-random text-success\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Function\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-retweet text-success\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Aggregate\n                    </a>\n                </li>\n                <li role=\"separator\" class=\"divider text-muted\"></li>\n                <li class=\"dropdown-header\"><span class=\"text-primary\">Table icons</span></li>\n                <li class=\"bg-info\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-fullscreen\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Partition Key\n                    </a>\n                </li>\n                <li class=\"bg-warning\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-pushpin\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Static Column\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-sort\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Clustering Column\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-sort-by-attributes\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Clustering Order ASC\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-sort-by-attributes-alt\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Clustering Order DESC\n                    </a>\n                </li>\n            </ul>\n        </li>\n        <li>\n            <a href=\"#\"></a>\n        </li>\n    </ul>\n</nav>\n<hr/>\n\n<div class=\"container\">\n    <!-- Keyspace -->\n    \n\n\n<div class=\"row\">\n    <div class=\"col-md-2\"></div>\n    <div class=\"col-md-8 col-offset-md-2\">\n        <div class=\"panel panel-default table-responsive table-bordered\">\n            <table class=\"table\">\n                \n                <caption>\n                    <h4 class=\"text-danger\">\n                        <span class=\"glyphicon glyphicon-folder-open\"></span>&nbsp;&nbsp;tlc_ks\n                    </h4>\n                </caption>\n                                <thead>\n                <tr>\n                    <th class=\"col-md-10\" style=\"text-align:left\">Replication</th>\n                    <th class=\"col-md-2\" style=\"text-align:left\">Durable Writes</th>\n                </tr>\n                </thead>\n                <tbody>\n                    <tr>\n                        <td class=\"col-md-10\" style=\"text-align:left\">{'class' : 'org.apache.cassandra.locator.SimpleStrategy', 'replication_factor' : '1'}</td>\n                        <td class=\"col-md-2\" style=\"text-align:left\">true</td>\n                    </tr>\n                <tbody>\n            </table>\n            <div class=\"panel-footer\">\n                <a data-toggle=\"collapse\" data-target=\"#2bb60090-adb1-11f0-8e48-0b293a0e2b08_asCQL\" class=\"text-danger\">\n                    <strong>As CQL statement</strong>\n                    <span class=\"caret\"></span>\n                </a>\n                <br/><br/>\n                <div class=\"collapse\" id=\"2bb60090-adb1-11f0-8e48-0b293a0e2b08_asCQL\">\n                    <pre class=\"well\">CREATE KEYSPACE tlc_ks WITH replication = { \n\t'class' : 'org.apache.cassandra.locator.SimpleStrategy', \n\t'replication_factor': '1' } AND durable_writes = true;</pre>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-2\"></div>\n</div>\n\n    <!-- Tables -->\n    <div class=\"row\"></div>\n    \n\n    <table width=\"100%\">\n        <td><hr /></td>\n        <td style=\"width:1px; padding: 0 10px; white-space: nowrap;\"><strong class=\"text-primary\">Tables</strong></td>\n        <td><hr /></td>\n    </table>\n    <div class=\"row\">\n        <div class=\"panel-group\" role=\"tablist\" aria-multiselectable=\"true\">\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#2bb69cd0-adb1-11f0-8e48-0b293a0e2b08\" aria-expanded=\"false\">\n                            <span class=\"text-primary\">\n                                <span class=\"glyphicon glyphicon-th-list\"></span>&nbsp;tlc_raw\n                            </span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"2bb69cd0-adb1-11f0-8e48-0b293a0e2b08\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        \n\n<div class=\"row\">\n    <div class=\"col-md-2\"></div>\n    <div class=\"col-md-8 col-offset-md-2\">\n        <div class=\"panel panel-default table-responsive table-bordered\">\n            <table class=\"table\">\n                                <thead>\n                    <tr>\n                        <th class=\"col-md-4\" width=\"10%\">Column Type</th>\n                        <th class=\"col-md-4\">Column Name</th>\n                        <th class=\"col-md-4\" style=\"text-align:left\">Data Type</th>\n                    </tr>\n                </thead>\n                <tbody>\n                                            \n\n                    <tr class=\"info\">\n                        <td class=\"col-md-4\" width=\"10%\">\n                            <span class=\"glyphicon glyphicon-fullscreen\" title=\"Partition Key\"></span>\n                        </td>\n                        <td class=\"col-md-4\">pickup_date</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">date</td>\n                    </tr>\n                                                                    \n                    <tr class=\"success\">\n                        <td class=\"col-md-4\" width=\"10%\">\n                            <span class=\"glyphicon glyphicon-sort\" title=\"Clustering Column\"></span>\n                            &nbsp;\n                            <span class=\"glyphicon glyphicon-sort-by-attributes-alt\" title=\"Sort DESC\"></span>\n                        </td>\n                        <td class=\"col-md-4\">trip_ts</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">timestamp</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">airport_fee</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">cbd_congestion_fee</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">congestion_surcharge</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">do_borough</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">dolocationid</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">dropoff_day</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">dropoff_location_name</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">extra</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">fare_amount</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">hour_of_day</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">improvement_surcharge</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">mta_tax</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">passenger_count</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">payment_type</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">pickup_day</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">pickup_location_name</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">pu_borough</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">pulocationid</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">ratecodeid</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">speed_miles_pr_hour</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">store_and_fwd_flag</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">tip_amount</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">tolls_amount</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">total_amount</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">tpep_dropoff_datetime</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">timestamp</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">tpep_pickup_datetime</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">timestamp</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">trip_distance</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">trip_duration_min</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">vendorid</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                            </tbody>\n            </table>\n            <div class=\"panel-footer\">\n                <a data-toggle=\"collapse\" data-target=\"#2bb6eaf0-adb1-11f0-8e48-0b293a0e2b08_asCQL\" class=\"text-primary\">\n                    <strong>As CQL statement</strong>\n                    <span class=\"caret\"></span>\n                </a>\n                <br/><br/>\n                <div class=\"collapse\" id=\"2bb6eaf0-adb1-11f0-8e48-0b293a0e2b08_asCQL\">\n                    <pre class=\"well\">CREATE TABLE tlc_ks.tlc_raw (\n    pickup_date date,\n    trip_ts timestamp,\n    airport_fee double,\n    cbd_congestion_fee double,\n    congestion_surcharge double,\n    do_borough text,\n    dolocationid int,\n    dropoff_day int,\n    dropoff_location_name text,\n    extra double,\n    fare_amount double,\n    hour_of_day text,\n    improvement_surcharge double,\n    mta_tax double,\n    passenger_count int,\n    payment_type int,\n    pickup_day int,\n    pickup_location_name text,\n    pu_borough text,\n    pulocationid int,\n    ratecodeid int,\n    speed_miles_pr_hour double,\n    store_and_fwd_flag text,\n    tip_amount double,\n    tolls_amount double,\n    total_amount double,\n    tpep_dropoff_datetime timestamp,\n    tpep_pickup_datetime timestamp,\n    trip_distance double,\n    trip_duration_min double,\n    vendorid int,\n    PRIMARY KEY (pickup_date, trip_ts)\n) WITH CLUSTERING ORDER BY (trip_ts DESC)\n    AND additional_write_policy = '99p'\n    AND bloom_filter_fp_chance = 0.01\n    AND caching = {'keys':'ALL','rows_per_partition':'NONE'}\n    AND comment = ''\n    AND compaction = {'class':'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy','max_threshold':'32','min_threshold':'4'}\n    AND compression = {'chunk_length_in_kb':'16','class':'org.apache.cassandra.io.compress.LZ4Compressor'}\n    AND crc_check_chance = 1.0\n    AND default_time_to_live = 0\n    AND extensions = {}\n    AND gc_grace_seconds = 864000\n    AND max_index_interval = 2048\n    AND memtable_flush_period_in_ms = 0\n    AND min_index_interval = 128\n    AND read_repair = 'BLOCKING'\n    AND speculative_retry = '99p';</pre>\n                </div>\n            </div>\n        </div>\n            </div>\n    <div class=\"col-md-2\"></div>\n</div>\n                    </div>\n                 </div>\n            </div>\n            \n        </div>\n    </div>\n    \n    \n    \n    \n    \n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094331_683003726","id":"paragraph_1760701381009_1447224275","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:34:50+0000","dateFinished":"2025-10-20T12:34:50+0000","status":"FINISHED"},{"text":"%cassandra\nUSE tlc_ks;\n\nDROP TABLE tlc_raw;","user":"anonymous","dateUpdated":"2025-10-20T12:08:14+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n\n\n\n\n<div class=\"container\">\n<div class=\"row\">\n  <h5>No Result &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n    <a role=\"button\" data-toggle=\"collapse\" data-target=\"#2a282a58-9d72-4607-9fcd-4b653cb64423\" aria-expanded=\"false\">\n      <span class=\"text-info\"><strong>Last query execution info</strong></span>\n    </a>\n  </h5>\n</div>\n<div class=\"panel panel-default\">\n  <div id=\"2a282a58-9d72-4607-9fcd-4b653cb64423\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n    <div class=\"panel-body\">\n      <div class=\"row\">\n        <div class=\"col-md-3\"></div>\n        <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th>Information</th>\n                <th style=\"text-align:left\">Value</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td>Statement</td>\n                <td style=\"text-align:left\">DROP TABLE tlc_raw;</td>\n              </tr>\n              <tr>\n                <td>Tried Hosts</td>\n                <td style=\"text-align:left\">cassandra-1:9042</td>\n              </tr>\n              <tr>\n                <td>Queried Hosts</td>\n                <td style=\"text-align:left\">cassandra-1:9042</td>\n              </tr>\n              <tr>\n                <td>Schema in Agreement</td>\n                <td style=\"text-align:left\">true</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094332_1239154647","id":"paragraph_1760783421119_957371723","dateCreated":"2025-10-20T12:08:14+0000","status":"READY"},{"text":"%cassandra\nUSE tlc_ks;\n\nCREATE TABLE tlc_raw (\n  pickup_date date,\n  trip_ts timestamp,\n  VendorID int,\n  tpep_pickup_datetime timestamp,\n  tpep_dropoff_datetime timestamp,\n  passenger_count int,\n  trip_distance double,\n  RatecodeID int,\n  store_and_fwd_flag text,\n  PULocationID int,\n  DOLocationID int,\n  payment_type int,\n  fare_amount double,\n  extra double,\n  mta_tax double,\n  tip_amount double,\n  tolls_amount double,\n  improvement_surcharge double,\n  total_amount double,\n  congestion_surcharge double,\n  Airport_fee double,\n  cbd_congestion_fee double,\n  pickup_day int,\n  dropoff_day int,\n  Speed_miles_pr_hour double,\n  trip_duration_min double,\n  hour_of_day text,\n  pickup_location_name text,\n  PU_Borough text,\n  dropoff_location_name text,\n  DO_Borough text,\n  PRIMARY KEY ((pickup_date), trip_ts)\n) WITH CLUSTERING ORDER BY (trip_ts DESC);\n","user":"anonymous","dateUpdated":"2025-10-20T12:34:43+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n\n\n\n\n<div class=\"container\">\n<div class=\"row\">\n  <h5>No Result &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n    <a role=\"button\" data-toggle=\"collapse\" data-target=\"#c0075c9e-12be-44fd-bf4f-698a941850a3\" aria-expanded=\"false\">\n      <span class=\"text-info\"><strong>Last query execution info</strong></span>\n    </a>\n  </h5>\n</div>\n<div class=\"panel panel-default\">\n  <div id=\"c0075c9e-12be-44fd-bf4f-698a941850a3\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n    <div class=\"panel-body\">\n      <div class=\"row\">\n        <div class=\"col-md-3\"></div>\n        <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th>Information</th>\n                <th style=\"text-align:left\">Value</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td>Statement</td>\n                <td style=\"text-align:left\">CREATE TABLE tlc_raw (\n  pickup_date date,\n  trip_ts timestamp,\n  VendorID int,\n  tpep_pickup_datetime timestamp,\n  tpep_dropoff_datetime timestamp,\n  passenger_count int,\n  trip_distance double,\n  RatecodeID int,\n  store_and_fwd_flag text,\n  PULocationID int,\n  DOLocationID int,\n  payment_type int,\n  fare_amount double,\n  extra double,\n  mta_tax double,\n  tip_amount double,\n  tolls_amount double,\n  improvement_surcharge double,\n  total_amount double,\n  congestion_surcharge double,\n  Airport_fee double,\n  cbd_congestion_fee double,\n  pickup_day int,\n  dropoff_day int,\n  Speed_miles_pr_hour double,\n  trip_duration_min double,\n  hour_of_day text,\n  pickup_location_name text,\n  PU_Borough text,\n  dropoff_location_name text,\n  DO_Borough text,\n  PRIMARY KEY ((pickup_date), trip_ts)\n) WITH CLUSTERING ORDER BY (trip_ts DESC);</td>\n              </tr>\n              <tr>\n                <td>Tried Hosts</td>\n                <td style=\"text-align:left\">cassandra-seed:9042</td>\n              </tr>\n              <tr>\n                <td>Queried Hosts</td>\n                <td style=\"text-align:left\">cassandra-seed:9042</td>\n              </tr>\n              <tr>\n                <td>Schema in Agreement</td>\n                <td style=\"text-align:left\">true</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094333_516075633","id":"paragraph_1760703529183_1534692817","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:34:44+0000","dateFinished":"2025-10-20T12:34:45+0000","status":"FINISHED"},{"text":"%spark\nval out = df\n\t.withColumn(\"pickup_date\", to_date(col(\"tpep_pickup_datetime\")))\n\t.withColumn(\"trip_ts\", col(\"tpep_pickup_datetime\").cast(\"timestamp\"))\n\t.withColumn(\"passenger_count\", col(\"passenger_count\").cast(\"int\"))\n\t.withColumn(\"ratecodeid\", col(\"RatecodeID\").cast(\"int\"))\n\t.withColumn(\"payment_type\", col(\"payment_type\").cast(\"int\"))\n\t.withColumn(\"vendorid\", col(\"VendorID\"))\n\t.withColumn(\"pulocationid\", col(\"PULocationID\"))\n\t.withColumn(\"dolocationid\", col(\"DOLocationID\"))\n\t.withColumn(\"airport_fee\", col(\"Airport_fee\"))\n\t.withColumn(\"speed_miles_pr_hour\", col(\"Speed_miles_pr_hour\"))\n\t.withColumn(\"pu_borough\", col(\"PU_Borough\"))\n\t.withColumn(\"do_borough\", col(\"DO_Borough\"))\n\t.select(\n\t\tcol(\"pickup_date\"),\n\t\tcol(\"trip_ts\"),\n\t\tcol(\"airport_fee\"),\n\t\tcol(\"cbd_congestion_fee\"),\n\t\tcol(\"congestion_surcharge\"),\n\t\tcol(\"do_borough\"),\n\t\tcol(\"dolocationid\"),\n\t\tcol(\"dropoff_day\"),\n\t\tcol(\"dropoff_location_name\"),\n\t\tcol(\"extra\"),\n\t\tcol(\"fare_amount\"),\n\t\tcol(\"hour_of_day\"),\n\t\tcol(\"improvement_surcharge\"),\n\t\tcol(\"mta_tax\"),\n\t\tcol(\"passenger_count\"),\n\t\tcol(\"payment_type\"),\n\t\tcol(\"pickup_day\"),\n\t\tcol(\"pickup_location_name\"),\n\t\tcol(\"pu_borough\"),\n\t\tcol(\"pulocationid\"),\n\t\tcol(\"ratecodeid\"),\n\t\tcol(\"speed_miles_pr_hour\"),\n\t\tcol(\"store_and_fwd_flag\"),\n\t\tcol(\"tip_amount\"),\n\t\tcol(\"tolls_amount\"),\n\t\tcol(\"total_amount\"),\n\t\tcol(\"tpep_dropoff_datetime\").cast(\"timestamp\"),\n\t\tcol(\"tpep_pickup_datetime\").cast(\"timestamp\"),\n\t\tcol(\"trip_distance\"),\n\t\tcol(\"trip_duration_min\"),\n\t\tcol(\"vendorid\")\n\t\t)","user":"anonymous","dateUpdated":"2025-10-20T12:37:06+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mout\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pickup_date: date, trip_ts: timestamp ... 29 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094333_2125897114","id":"paragraph_1760704109626_1625388577","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:37:06+0000","dateFinished":"2025-10-20T12:37:07+0000","status":"FINISHED"},{"text":"%spark\nout.printSchema()","user":"anonymous","dateUpdated":"2025-10-20T12:37:20+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- pickup_date: date (nullable = true)\n |-- trip_ts: timestamp (nullable = true)\n |-- airport_fee: double (nullable = true)\n |-- cbd_congestion_fee: double (nullable = true)\n |-- congestion_surcharge: double (nullable = true)\n |-- do_borough: string (nullable = true)\n |-- dolocationid: integer (nullable = true)\n |-- dropoff_day: integer (nullable = true)\n |-- dropoff_location_name: string (nullable = true)\n |-- extra: double (nullable = true)\n |-- fare_amount: double (nullable = true)\n |-- hour_of_day: string (nullable = true)\n |-- improvement_surcharge: double (nullable = true)\n |-- mta_tax: double (nullable = true)\n |-- passenger_count: integer (nullable = true)\n |-- payment_type: integer (nullable = true)\n |-- pickup_day: integer (nullable = true)\n |-- pickup_location_name: string (nullable = true)\n |-- pu_borough: string (nullable = true)\n |-- pulocationid: integer (nullable = true)\n |-- ratecodeid: integer (nullable = true)\n |-- speed_miles_pr_hour: double (nullable = true)\n |-- store_and_fwd_flag: string (nullable = true)\n |-- tip_amount: double (nullable = true)\n |-- tolls_amount: double (nullable = true)\n |-- total_amount: double (nullable = true)\n |-- tpep_dropoff_datetime: timestamp (nullable = true)\n |-- tpep_pickup_datetime: timestamp (nullable = true)\n |-- trip_distance: double (nullable = true)\n |-- trip_duration_min: double (nullable = true)\n |-- vendorid: integer (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760963830160_867071662","id":"paragraph_1760963830160_867071662","dateCreated":"2025-10-20T12:37:10+0000","dateStarted":"2025-10-20T12:37:20+0000","dateFinished":"2025-10-20T12:37:21+0000","status":"FINISHED"},{"text":"%spark\nout.count()","user":"anonymous","dateUpdated":"2025-10-20T12:40:37+0000","progress":14,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres18\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 2848140\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=19"},{"jobUrl":"http://localhost:4040/jobs/job?id=20"},{"jobUrl":"http://localhost:4040/jobs/job?id=21"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760964031834_1185478452","id":"paragraph_1760964031834_1185478452","dateCreated":"2025-10-20T12:40:31+0000","dateStarted":"2025-10-20T12:40:38+0000","dateFinished":"2025-10-20T12:40:47+0000","status":"FINISHED"},{"text":"%spark\nout.write\n  .format(\"org.apache.spark.sql.cassandra\")\n  .options(Map(\"keyspace\" -> \"tlc_ks\", \"table\" -> \"tlc_raw\"))\n  .mode(\"append\")\n  .save()","user":"anonymous","dateUpdated":"2025-10-20T12:40:56+0000","progress":100,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=22"},{"jobUrl":"http://localhost:4040/jobs/job?id=23"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760963802955_1815519372","id":"paragraph_1760963802955_1815519372","dateCreated":"2025-10-20T12:36:42+0000","dateStarted":"2025-10-20T12:40:56+0000","dateFinished":"2025-10-20T12:44:45+0000","status":"FINISHED"},{"text":"%cassandra\nUSE tlc_ks;\n\nSELECT *\nFROM tlc_raw\nWHERE passenger_count = 2;","user":"anonymous","dateUpdated":"2025-10-20T13:04:34+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"com.datastax.oss.driver.api.core.servererrors.InvalidQueryException: Cannot execute this query as it might involve data filtering and thus may have unpredictable performance. If you want to execute this query despite the performance unpredictability, use ALLOW FILTERING\n\tat com.datastax.oss.driver.api.core.servererrors.InvalidQueryException.copy(InvalidQueryException.java:48)\n\tat com.datastax.oss.driver.internal.core.util.concurrent.CompletableFutures.getUninterruptibly(CompletableFutures.java:149)\n\tat com.datastax.oss.driver.internal.core.cql.CqlRequestSyncProcessor.process(CqlRequestSyncProcessor.java:53)\n\tat com.datastax.oss.driver.internal.core.cql.CqlRequestSyncProcessor.process(CqlRequestSyncProcessor.java:30)\n\tat com.datastax.oss.driver.internal.core.session.DefaultSession.execute(DefaultSession.java:230)\n\tat com.datastax.oss.driver.api.core.cql.SyncCqlSession.execute(SyncCqlSession.java:54)\n\tat org.apache.zeppelin.cassandra.EnhancedSession.executeStatement(EnhancedSession.scala:203)\n\tat org.apache.zeppelin.cassandra.EnhancedSession.execute(EnhancedSession.scala:240)\n\tat org.apache.zeppelin.cassandra.InterpreterLogic.$anonfun$interpret$15(InterpreterLogic.scala:158)\n\tat scala.collection.immutable.List.map(List.scala:297)\n\tat org.apache.zeppelin.cassandra.InterpreterLogic.interpret(InterpreterLogic.scala:157)\n\tat org.apache.zeppelin.cassandra.CassandraInterpreter.interpret(CassandraInterpreter.java:388)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:109)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:824)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:716)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:187)\n\tat org.apache.zeppelin.scheduler.AbstractScheduler.runJob(AbstractScheduler.java:136)\n\tat org.apache.zeppelin.scheduler.ParallelScheduler.lambda$runJobInScheduler$0(ParallelScheduler.java:42)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:829)\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760965109422_672526754","id":"paragraph_1760965109422_672526754","dateCreated":"2025-10-20T12:58:29+0000","dateStarted":"2025-10-20T13:04:34+0000","dateFinished":"2025-10-20T13:04:34+0000","status":"ERROR"},{"text":"%cassandra\nSELECT sum(partitions_count) AS est_partitions\nFROM system.size_estimates\nWHERE keyspace_name='tlc_ks' AND table_name='tlc_raw';","user":"anonymous","dateUpdated":"2025-10-20T12:52:27+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"est_partitions\n1108\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760964077832_1124151386","id":"paragraph_1760964077832_1124151386","dateCreated":"2025-10-20T12:41:17+0000","dateStarted":"2025-10-20T12:52:27+0000","dateFinished":"2025-10-20T12:52:27+0000","status":"FINISHED"},{"text":"%spark\nval CQLcount = spark.read\n  .format(\"org.apache.spark.sql.cassandra\")\n  .options(Map(\"keyspace\" -> \"tlc_ks\", \"table\" -> \"tlc_raw\"))\n  .load()\nCQLcount.count()   // accurate row count; still scans everything\n","user":"anonymous","dateUpdated":"2025-10-20T13:16:43+0000","progress":97,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mCQLcount\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pickup_date: date, trip_ts: timestamp ... 29 more fields]\n\u001b[1m\u001b[34mres27\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1538741\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=34"},{"jobUrl":"http://localhost:4040/jobs/job?id=35"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760964791113_256120080","id":"paragraph_1760964791113_256120080","dateCreated":"2025-10-20T12:53:11+0000","dateStarted":"2025-10-20T13:16:43+0000","dateFinished":"2025-10-20T13:16:58+0000","status":"FINISHED"},{"text":"%spark\nout.select(col(\"trip_ts\")).distinct().count()","user":"anonymous","dateUpdated":"2025-10-20T13:17:00+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres28\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1538741\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=36"},{"jobUrl":"http://localhost:4040/jobs/job?id=37"},{"jobUrl":"http://localhost:4040/jobs/job?id=38"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760965860544_1773417557","id":"paragraph_1760965860544_1773417557","dateCreated":"2025-10-20T13:11:00+0000","dateStarted":"2025-10-20T13:17:00+0000","dateFinished":"2025-10-20T13:17:11+0000","status":"FINISHED"},{"text":"%spark\nCQLcount.show(3, truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T13:08:08+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-------------------+-----------+------------------+--------------------+----------+------------+-----------+-----------------------+-----+-----------+-----------+---------------------+-------+---------------+------------+----------+--------------------+----------+------------+----------+-------------------+------------------+----------+------------+------------+---------------------+--------------------+-------------+-----------------+--------+\n|pickup_date|trip_ts            |airport_fee|cbd_congestion_fee|congestion_surcharge|do_borough|dolocationid|dropoff_day|dropoff_location_name  |extra|fare_amount|hour_of_day|improvement_surcharge|mta_tax|passenger_count|payment_type|pickup_day|pickup_location_name|pu_borough|pulocationid|ratecodeid|speed_miles_pr_hour|store_and_fwd_flag|tip_amount|tolls_amount|total_amount|tpep_dropoff_datetime|tpep_pickup_datetime|trip_distance|trip_duration_min|vendorid|\n+-----------+-------------------+-----------+------------------+--------------------+----------+------------+-----------+-----------------------+-----+-----------+-----------+---------------------+-------+---------------+------------+----------+--------------------+----------+------------+----------+-------------------+------------------+----------+------------+------------+---------------------+--------------------+-------------+-----------------+--------+\n|2025-01-14 |2025-01-14 23:59:58|0.0        |0.75              |2.5                 |Manhattan |161         |4          |Midtown Center         |1.0  |9.3        |23         |1.0                  |0.5    |2              |1           |3         |Midtown North       |Manhattan |163         |1         |9.42               |N                 |5.0       |0.0         |20.05       |2025-01-15 00:07:44  |2025-01-14 23:59:58 |1.22         |7.77             |2       |\n|2025-01-14 |2025-01-14 23:59:57|0.0        |0.75              |2.5                 |Manhattan |232         |4          |Two Bridges/Seward Park|1.0  |17.0       |23         |1.0                  |0.5    |1              |2           |3         |Garment District    |Manhattan |100         |1         |17.04              |N                 |0.0       |0.0         |22.75       |2025-01-15 00:11:30  |2025-01-14 23:59:57 |3.28         |11.55            |2       |\n|2025-01-14 |2025-01-14 23:59:53|1.75       |0.0               |0.0                 |Brooklyn  |181         |4          |Park Slope             |1.0  |96.1       |23         |1.0                  |0.5    |1              |4           |3         |JFK Airport         |Queens    |132         |1         |45.37              |N                 |0.0       |0.0         |100.35      |2025-01-15 00:34:46  |2025-01-14 23:59:53 |26.38        |34.88            |2       |\n+-----------+-------------------+-----------+------------------+--------------------+----------+------------+-----------+-----------------------+-----+-----------+-----------+---------------------+-------+---------------+------------+----------+--------------------+----------+------------+----------+-------------------+------------------+----------+------------+------------+---------------------+--------------------+-------------+-----------------+--------+\nonly showing top 3 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=26"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760965668811_1051589588","id":"paragraph_1760965668811_1051589588","dateCreated":"2025-10-20T13:07:48+0000","dateStarted":"2025-10-20T13:08:08+0000","dateFinished":"2025-10-20T13:08:11+0000","status":"FINISHED"},{"text":"%spark\nCQLcount.printSchema()","user":"anonymous","dateUpdated":"2025-10-20T13:09:01+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- pickup_date: date (nullable = false)\n |-- trip_ts: timestamp (nullable = true)\n |-- airport_fee: double (nullable = true)\n |-- cbd_congestion_fee: double (nullable = true)\n |-- congestion_surcharge: double (nullable = true)\n |-- do_borough: string (nullable = true)\n |-- dolocationid: integer (nullable = true)\n |-- dropoff_day: integer (nullable = true)\n |-- dropoff_location_name: string (nullable = true)\n |-- extra: double (nullable = true)\n |-- fare_amount: double (nullable = true)\n |-- hour_of_day: string (nullable = true)\n |-- improvement_surcharge: double (nullable = true)\n |-- mta_tax: double (nullable = true)\n |-- passenger_count: integer (nullable = true)\n |-- payment_type: integer (nullable = true)\n |-- pickup_day: integer (nullable = true)\n |-- pickup_location_name: string (nullable = true)\n |-- pu_borough: string (nullable = true)\n |-- pulocationid: integer (nullable = true)\n |-- ratecodeid: integer (nullable = true)\n |-- speed_miles_pr_hour: double (nullable = true)\n |-- store_and_fwd_flag: string (nullable = true)\n |-- tip_amount: double (nullable = true)\n |-- tolls_amount: double (nullable = true)\n |-- total_amount: double (nullable = true)\n |-- tpep_dropoff_datetime: timestamp (nullable = true)\n |-- tpep_pickup_datetime: timestamp (nullable = true)\n |-- trip_distance: double (nullable = true)\n |-- trip_duration_min: double (nullable = true)\n |-- vendorid: integer (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760965691559_1146887335","id":"paragraph_1760965691559_1146887335","dateCreated":"2025-10-20T13:08:11+0000","dateStarted":"2025-10-20T13:09:01+0000","dateFinished":"2025-10-20T13:09:02+0000","status":"FINISHED"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2025-10-20T13:10:26+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760965826888_875027266","id":"paragraph_1760965826888_875027266","dateCreated":"2025-10-20T13:10:26+0000","status":"READY"},{"text":"%sh\ngetent hosts cassandra-seed cassandra-1 cassandra-2 || true\nnc -vz cassandra-seed 9042 || true\n","user":"anonymous","dateUpdated":"2025-10-20T12:47:08+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"172.18.0.9      cassandra-sebash: line 1: nc: command not found\ned\n172.18.0.8      cassandra-1\n172.18.0.7      cassandra-2\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094335_1018494180","id":"paragraph_1760793908616_1369215959","dateCreated":"2025-10-20T12:08:14+0000","dateStarted":"2025-10-20T12:47:08+0000","dateFinished":"2025-10-20T12:47:13+0000","status":"FINISHED"},{"text":"%sh\n# Do the names resolve?\ngetent hosts cassandra-seed cassandra-1 cassandra-2 || true\n\n# Is 9042 open on at least one?\nnc -vz cassandra-seed 9042 || true\n\n# Can cqlsh connect?\ncqlsh cassandra-seed 9042 -e \"SELECT cluster_name, data_center FROM system.local;\" || true\n","user":"anonymous","dateUpdated":"2025-10-20T12:08:14+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"172.18.0.3      cassandra-seed\n172.18.0.2      cassandra-1bash: line 4: nc: command not found\nbash: line 7: cqlsh:\n172.18.0.9   c o m  cassandra-2\nmand not found\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094335_135034553","id":"paragraph_1760795361153_1667882465","dateCreated":"2025-10-20T12:08:14+0000","status":"READY"},{"text":"%sh\ndocker ps --format 'table {{.Names}}\\t{{.Status}}\\t{{.Ports}}'\n\n# Check node status (inside any Cassandra container)\ndocker exec -it cassandra-seed nodetool status\n\n# Look for native transport in logs\ndocker logs cassandra-seed | grep -i \"Native transport\" -n | tail -3\n","user":"anonymous","dateUpdated":"2025-10-20T12:08:14+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"bash: docker: command not found\nbash: line 3: docker: command not found\nbash: line 6: docker: command not found\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094336_207084209","id":"paragraph_1760795385317_1305700683","dateCreated":"2025-10-20T12:08:14+0000","status":"READY"},{"text":"%spark\nspark.read.format(\"org.apache.spark.sql.cassandra\")\n  .options(Map(\"keyspace\" -> \"system\", \"table\" -> \"local\"))\n  .load()\n  .select(\"key\",\"cluster_name\",\"data_center\")\n  .show(false)\n","user":"anonymous","dateUpdated":"2025-10-20T12:08:14+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.sql.catalyst.analysis.NoSuchNamespaceException: Couldn't find system or any similarly named keyspaces\n  at com.datastax.spark.connector.datasource.CassandraCatalog$.namespaceMissing(CassandraCatalog.scala:471)\n  at com.datastax.spark.connector.datasource.CassandraCatalog$.$anonfun$getRelationMetaData$1(CassandraCatalog.scala:434)\n  at java.base/java.util.Optional.orElseThrow(Optional.java:408)\n  at com.datastax.spark.connector.datasource.CassandraCatalog$.getRelationMetaData(CassandraCatalog.scala:434)\n  at org.apache.spark.sql.cassandra.DefaultSource.getTable(DefaultSource.scala:63)\n  at org.apache.spark.sql.cassandra.DefaultSource.inferSchema(DefaultSource.scala:67)\n  at org.apache.spark.sql.execution.datasources.v2.DataSourceV2Utils$.getTableFromProvider(DataSourceV2Utils.scala:90)\n  at org.apache.spark.sql.execution.datasources.v2.DataSourceV2Utils$.loadV2Source(DataSourceV2Utils.scala:140)\n  at org.apache.spark.sql.DataFrameReader.$anonfun$load$1(DataFrameReader.scala:210)\n  at scala.Option.flatMap(Option.scala:271)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:208)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:172)\n  ... 54 elided\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094336_429429725","id":"paragraph_1760793963226_182231435","dateCreated":"2025-10-20T12:08:14+0000","status":"READY"},{"text":"%cassandra\nSELECT cluster_name, data_center FROM system.local;\n","user":"anonymous","dateUpdated":"2025-10-20T12:08:14+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cluster_name\tdata_center\ndemo-cluster\tdatacenter1\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094337_1757158858","id":"paragraph_1760791610611_2015667747","dateCreated":"2025-10-20T12:08:14+0000","status":"READY"},{"text":"%cassandra \nUSE tlc_ks;\n\nSELECT * FROM tlc_raw;","user":"anonymous","dateUpdated":"2025-10-20T12:08:14+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.zeppelin.interpreter.InterpreterException: com.datastax.oss.driver.api.core.AllNodesFailedException: Could not reach any contact point, make sure you've provided valid addresses (showing first 3 nodes, use getAllErrors() for more): Node(endPoint=cassandra-2:9042, hostId=null, hashCode=7407afa): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)], Node(endPoint=cassandra-seed:9042, hostId=null, hashCode=db8118a): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)], Node(endPoint=cassandra-1:9042, hostId=null, hashCode=37fee4d): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)]\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.open(LazyOpenInterpreter.java:77)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:808)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:716)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:187)\n\tat org.apache.zeppelin.scheduler.AbstractScheduler.runJob(AbstractScheduler.java:136)\n\tat org.apache.zeppelin.scheduler.ParallelScheduler.lambda$runJobInScheduler$0(ParallelScheduler.java:42)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:829)\nCaused by: com.datastax.oss.driver.api.core.AllNodesFailedException: Could not reach any contact point, make sure you've provided valid addresses (showing first 3 nodes, use getAllErrors() for more): Node(endPoint=cassandra-2:9042, hostId=null, hashCode=7407afa): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)], Node(endPoint=cassandra-seed:9042, hostId=null, hashCode=db8118a): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)], Node(endPoint=cassandra-1:9042, hostId=null, hashCode=37fee4d): [com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)]\n\tat com.datastax.oss.driver.api.core.AllNodesFailedException.copy(AllNodesFailedException.java:141)\n\tat com.datastax.oss.driver.internal.core.util.concurrent.CompletableFutures.getUninterruptibly(CompletableFutures.java:149)\n\tat com.datastax.oss.driver.api.core.session.SessionBuilder.build(SessionBuilder.java:835)\n\tat org.apache.zeppelin.cassandra.CassandraInterpreter.open(CassandraInterpreter.java:248)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.open(LazyOpenInterpreter.java:71)\n\t... 8 more\n\tSuppressed: com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler$InitRequest.fail(ProtocolInitHandler.java:356)\n\t\tat com.datastax.oss.driver.internal.core.channel.ChannelHandlerRequest.writeListener(ChannelHandlerRequest.java:87)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)\n\t\tat io.netty.util.concurrent.DefaultPromise.addListener(DefaultPromise.java:184)\n\t\tat io.netty.channel.DefaultChannelPromise.addListener(DefaultChannelPromise.java:95)\n\t\tat io.netty.channel.DefaultChannelPromise.addListener(DefaultChannelPromise.java:30)\n\t\tat com.datastax.oss.driver.internal.core.channel.ChannelHandlerRequest.send(ChannelHandlerRequest.java:76)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler$InitRequest.send(ProtocolInitHandler.java:193)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler.onRealConnect(ProtocolInitHandler.java:124)\n\t\tat com.datastax.oss.driver.internal.core.channel.ConnectInitHandler.lambda$connect$0(ConnectInitHandler.java:57)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)\n\t\tat io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)\n\t\tat io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)\n\t\tat io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)\n\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.fulfillConnectPromise(AbstractNioChannel.java:321)\n\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:337)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)\n\t\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)\n\t\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n\t\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\t\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\t\t... 1 more\n\t\tSuppressed: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: cassandra-2/172.18.0.4:9042\n\t\tCaused by: java.net.ConnectException: Connection refused\n\t\t\tat java.base/sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\t\t\tat java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:777)\n\t\t\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)\n\t\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)\n\t\t\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)\n\t\t\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n\t\t\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\t\t\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\t\t\tat java.base/java.lang.Thread.run(Thread.java:829)\n\tCaused by: io.netty.channel.StacklessClosedChannelException\n\t\tat io.netty.channel.AbstractChannel$AbstractUnsafe.flush0()(Unknown Source)\n\tSuppressed: com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler$InitRequest.fail(ProtocolInitHandler.java:356)\n\t\tat com.datastax.oss.driver.internal.core.channel.ChannelHandlerRequest.writeListener(ChannelHandlerRequest.java:87)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)\n\t\tat io.netty.util.concurrent.DefaultPromise.addListener(DefaultPromise.java:184)\n\t\tat io.netty.channel.DefaultChannelPromise.addListener(DefaultChannelPromise.java:95)\n\t\tat io.netty.channel.DefaultChannelPromise.addListener(DefaultChannelPromise.java:30)\n\t\tat com.datastax.oss.driver.internal.core.channel.ChannelHandlerRequest.send(ChannelHandlerRequest.java:76)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler$InitRequest.send(ProtocolInitHandler.java:193)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler.onRealConnect(ProtocolInitHandler.java:124)\n\t\tat com.datastax.oss.driver.internal.core.channel.ConnectInitHandler.lambda$connect$0(ConnectInitHandler.java:57)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)\n\t\tat io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)\n\t\tat io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)\n\t\tat io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)\n\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.fulfillConnectPromise(AbstractNioChannel.java:321)\n\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:337)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)\n\t\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)\n\t\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n\t\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\t\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\t\t... 1 more\n\t\tSuppressed: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: cassandra-seed/172.18.0.5:9042\n\t\tCaused by: java.net.ConnectException: Connection refused\n\t\t\tat java.base/sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\t\t\tat java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:777)\n\t\t\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)\n\t\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)\n\t\t\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)\n\t\t\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n\t\t\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\t\t\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\t\t\tat java.base/java.lang.Thread.run(Thread.java:829)\n\tCaused by: io.netty.channel.StacklessClosedChannelException\n\t\tat io.netty.channel.AbstractChannel$AbstractUnsafe.flush0()(Unknown Source)\n\tSuppressed: com.datastax.oss.driver.api.core.connection.ConnectionInitException: [s9|control|connecting...] Protocol initialization request, step 1 (OPTIONS): failed to send request (io.netty.channel.StacklessClosedChannelException)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler$InitRequest.fail(ProtocolInitHandler.java:356)\n\t\tat com.datastax.oss.driver.internal.core.channel.ChannelHandlerRequest.writeListener(ChannelHandlerRequest.java:87)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)\n\t\tat io.netty.util.concurrent.DefaultPromise.addListener(DefaultPromise.java:184)\n\t\tat io.netty.channel.DefaultChannelPromise.addListener(DefaultChannelPromise.java:95)\n\t\tat io.netty.channel.DefaultChannelPromise.addListener(DefaultChannelPromise.java:30)\n\t\tat com.datastax.oss.driver.internal.core.channel.ChannelHandlerRequest.send(ChannelHandlerRequest.java:76)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler$InitRequest.send(ProtocolInitHandler.java:193)\n\t\tat com.datastax.oss.driver.internal.core.channel.ProtocolInitHandler.onRealConnect(ProtocolInitHandler.java:124)\n\t\tat com.datastax.oss.driver.internal.core.channel.ConnectInitHandler.lambda$connect$0(ConnectInitHandler.java:57)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)\n\t\tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)\n\t\tat io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)\n\t\tat io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)\n\t\tat io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)\n\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.fulfillConnectPromise(AbstractNioChannel.java:321)\n\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:337)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)\n\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)\n\t\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)\n\t\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n\t\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\t\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\t\t... 1 more\n\t\tSuppressed: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: cassandra-1/172.18.0.6:9042\n\t\tCaused by: java.net.ConnectException: Connection refused\n\t\t\tat java.base/sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\t\t\tat java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:777)\n\t\t\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)\n\t\t\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)\n\t\t\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)\n\t\t\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)\n\t\t\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n\t\t\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\t\t\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\t\t\tat java.base/java.lang.Thread.run(Thread.java:829)\n\tCaused by: io.netty.channel.StacklessClosedChannelException\n\t\tat io.netty.channel.AbstractChannel$AbstractUnsafe.flush0()(Unknown Source)\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094338_1390438078","id":"paragraph_1760782075500_1017322159","dateCreated":"2025-10-20T12:08:14+0000","status":"READY"},{"text":"%cassandra\n","user":"anonymous","dateUpdated":"2025-10-20T12:08:14+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962094339_568543676","id":"paragraph_1760791071591_1684564809","dateCreated":"2025-10-20T12:08:14+0000","status":"READY"}],"name":"TLC_subset_CQL","id":"2MAPXMBM7","defaultInterpreterGroup":"spark","version":"0.12.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/TLC_subset_CQL"}