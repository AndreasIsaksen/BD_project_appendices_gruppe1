{"paragraphs":[{"text":"%spark\r\n// Import packages.\r\nimport spark.implicits._\r\nimport org.apache.spark.sql.types._\r\nimport org.apache.spark.sql.expressions._\r\nimport org.apache.spark.sql.functions._","user":"anonymous","dateUpdated":"2025-10-20T12:10:34+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.expressions._\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219548_321007475","id":"paragraph_1760926526162_934718276","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:10:34+0000","dateFinished":"2025-10-20T12:10:39+0000","status":"FINISHED","focus":false},{"text":"%spark\n// Import of TCL data:\n\n// Define Schema for TCL.\nval refPath = \"/sparkio/tlc_mock.parquet\"\nval refSchema = spark.read.parquet(refPath).schema\n\n// Define path for datafiles.\n\nval base = (\"/sparkio/tlc_mock.parquet\")\n\n// Load data into a DataFrame.\nval df = spark.read\n\t.option(\"recursiveFileLookup\", false)\n\t.schema(refSchema)\n\t.parquet(base)\n\n// Validate results.\nprint(\"Mock df\\n\")\ndf.show(truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T12:10:36+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Mock df\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+\n|VendorID|tpep_pickup_datetime|tpep_dropoff_datetime|passenger_count|trip_distance|RatecodeID|store_and_fwd_flag|PULocationID|DOLocationID|payment_type|fare_amount|extra|mta_tax|tip_amount|tolls_amount|improvement_surcharge|total_amount|congestion_surcharge|Airport_fee|cbd_congestion_fee|\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+\n|1       |2025-01-01 00:18:38 |2025-01-01 00:26:59  |1              |1.6          |1         |N                 |229         |237         |1           |10.0       |3.5  |0.5    |3.0       |0.0         |1.0                  |18.0        |2.5                 |0.0        |0.0               |\n|1       |2025-01-01 00:32:40 |2025-01-01 00:35:13  |1              |0.5          |1         |N                 |236         |237         |1           |5.1        |3.5  |0.5    |2.02      |0.0         |1.0                  |12.12       |2.5                 |0.0        |0.0               |\n|1       |2025-01-01 00:44:04 |2025-01-01 00:46:01  |1              |0.6          |1         |N                 |141         |141         |1           |5.1        |3.5  |0.5    |2.0       |0.0         |1.0                  |12.1        |2.5                 |0.0        |0.0               |\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+\n\n\u001b[1m\u001b[34mrefPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /sparkio/tlc_mock.parquet\n\u001b[1m\u001b[34mrefSchema\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.types.StructType\u001b[0m = StructType(StructField(VendorID,IntegerType,true),StructField(tpep_pickup_datetime,TimestampNTZType,true),StructField(tpep_dropoff_datetime,TimestampNTZType,true),StructField(passenger_count,LongType,true),StructField(trip_distance,DoubleType,true),StructField(RatecodeID,LongType,true),StructField(store_and_fwd_flag,StringType,true),StructField(PULocationID,IntegerType,true),StructField(DOLocationID,IntegerType,true),StructField(payment_type,LongType,true),StructField(fare_amount,DoubleType,true),StructField(extra,DoubleType,true),StructField(mta_tax,DoubleType,true),StructField(tip_amount,DoubleType,true),StructField(tolls_amount,DoubleType,...\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=2"},{"jobUrl":"http://localhost:4040/jobs/job?id=3"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219549_1621608047","id":"paragraph_1760926576809_2069668004","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:10:39+0000","dateFinished":"2025-10-20T12:10:45+0000","status":"FINISHED"},{"text":"%spark\n// Build trip_duration_min, hour_of_day, day_of_week.\nval dfWithSpeed =\n  df\n    .withColumn(\"pickup_day\", col(\"tpep_pickup_datetime\").cast(\"timestamp\"))\n    .withColumn(\"dropoff_day\", col(\"tpep_dropoff_datetime\").cast(\"timestamp\"))\n    .withColumn(\"pickup_sec\",  col(\"tpep_pickup_datetime\").cast(\"timestamp\").cast(\"long\"))\n    .withColumn(\"dropoff_sec\", col(\"tpep_dropoff_datetime\").cast(\"timestamp\").cast(\"long\"))\n    // duration in hours.\n    .withColumn(\"duration_hours\",\n      (col(\"dropoff_sec\") - col(\"pickup_sec\")) / 3600.0\n    )\n    // speed = miles / hours.\n    .withColumn(\n      \"Speed_miles_pr_hour\",\n      when(col(\"duration_hours\") > 0,\n           col(\"trip_distance\") / col(\"duration_hours\")\n      ).otherwise(lit(null).cast(\"double\"))\n    )\n    // Travel duration in minutes.\n    .withColumn(\n        \"trip_duration_min\",\n        when(not(col(\"duration_hours\").isNull),\n            col(\"duration_hours\") * 60\n        ).otherwise(lit(null).cast(\"double\"))\n    )\n    .drop(\"pickup_sec\",\"dropoff_sec\",\"duration_hours\")\n    .withColumn(\"Speed_miles_pr_hour\", round(col(\"Speed_miles_pr_hour\"), 2))\n    .withColumn(\"trip_duration_min\", round(col(\"trip_duration_min\"), 2))\n    .withColumn(\"hour_of_day\", date_format(col(\"pickup_day\"), \"k\"))\n    .withColumn(\"pickup_day\", dayofweek(col(\"pickup_day\")))\n    .withColumn(\"dropoff_day\", dayofweek(col(\"dropoff_day\")))\n\ndfWithSpeed.show(truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T12:10:37+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+\n|VendorID|tpep_pickup_datetime|tpep_dropoff_datetime|passenger_count|trip_distance|RatecodeID|store_and_fwd_flag|PULocationID|DOLocationID|payment_type|fare_amount|extra|mta_tax|tip_amount|tolls_amount|improvement_surcharge|total_amount|congestion_surcharge|Airport_fee|cbd_congestion_fee|pickup_day|dropoff_day|Speed_miles_pr_hour|trip_duration_min|hour_of_day|\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+\n|1       |2025-01-01 00:18:38 |2025-01-01 00:26:59  |1              |1.6          |1         |N                 |229         |237         |1           |10.0       |3.5  |0.5    |3.0       |0.0         |1.0                  |18.0        |2.5                 |0.0        |0.0               |4         |4          |11.5               |8.35             |24         |\n|1       |2025-01-01 00:32:40 |2025-01-01 00:35:13  |1              |0.5          |1         |N                 |236         |237         |1           |5.1        |3.5  |0.5    |2.02      |0.0         |1.0                  |12.12       |2.5                 |0.0        |0.0               |4         |4          |11.76              |2.55             |24         |\n|1       |2025-01-01 00:44:04 |2025-01-01 00:46:01  |1              |0.6          |1         |N                 |141         |141         |1           |5.1        |3.5  |0.5    |2.0       |0.0         |1.0                  |12.1        |2.5                 |0.0        |0.0               |4         |4          |18.46              |1.95             |24         |\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+\n\n\u001b[1m\u001b[34mdfWithSpeed\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 23 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=4"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219550_692560212","id":"paragraph_1760926593710_1057647642","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:10:45+0000","dateFinished":"2025-10-20T12:10:50+0000","status":"FINISHED"},{"text":"%spark\n// Import of MapZone data:\n\n//File location.\nval base = (\"/sparkio/TLC/mapZones/taxi_zone_lookup.csv\")\n\n// Custom schema (LocationID got defined as a string without).\nval zoneSchema = StructType(Array(\n    StructField(\"LocationID\", IntegerType, true),\n    StructField(\"Borough\", StringType, true),\n    StructField(\"Zone\", StringType, true),\n    StructField(\"service_zone\", StringType, true)\n))\n\n// Import of data to df.\nval dfZone = spark.read\n\t.option(\"header\", \"true\")\n    .schema(zoneSchema)\n    .csv(base)\n\n// Validating content of new df.\ndfZone.show(3, truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T12:10:39+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-------+-----------------------+------------+\n|LocationID|Borough|Zone                   |service_zone|\n+----------+-------+-----------------------+------------+\n|1         |EWR    |Newark Airport         |EWR         |\n|2         |Queens |Jamaica Bay            |Boro Zone   |\n|3         |Bronx  |Allerton/Pelham Gardens|Boro Zone   |\n+----------+-------+-----------------------+------------+\nonly showing top 3 rows\n\n\u001b[1m\u001b[34mbase\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /sparkio/TLC/mapZones/taxi_zone_lookup.csv\n\u001b[1m\u001b[34mzoneSchema\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.types.StructType\u001b[0m = StructType(StructField(LocationID,IntegerType,true),StructField(Borough,StringType,true),StructField(Zone,StringType,true),StructField(service_zone,StringType,true))\n\u001b[1m\u001b[34mdfZone\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [LocationID: int, Borough: string ... 2 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=5"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219550_2085725241","id":"paragraph_1760926788529_336408228","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:10:50+0000","dateFinished":"2025-10-20T12:10:55+0000","status":"FINISHED"},{"text":"%spark\n// Create new df to contain location names corresponding with locationIDs.\n// Two left joins to add pickup and dropoff location names.\nval dfWithLocationNames =\n  dfWithSpeed.alias(\"m\")\n    .join(dfZone.alias(\"zpu\"),\n        col(\"m.PULocationID\") === col(\"zpu.LocationID\"),\n        \"left\")\n    .join(dfZone.alias(\"zdo\"),\n        col(\"m.DOLocationID\") === col (\"zdo.LocationID\"),\n        \"left\")\n    .select(col(\"m.*\"),\n        col(\"zpu.Zone\").as(\"pickup_location_name\"),\n        col(\"zpu.Borough\").as(\"PU_Borough\"),\n        col(\"zdo.Zone\").as(\"dropoff_location_name\"),\n        col(\"zdo.Borough\").as(\"DO_Borough\"))\n\n// Validate content of new df.\ndfWithLocationNames.show(3, truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T12:10:41+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\n|VendorID|tpep_pickup_datetime|tpep_dropoff_datetime|passenger_count|trip_distance|RatecodeID|store_and_fwd_flag|PULocationID|DOLocationID|payment_type|fare_amount|extra|mta_tax|tip_amount|tolls_amount|improvement_surcharge|total_amount|congestion_surcharge|Airport_fee|cbd_congestion_fee|pickup_day|dropoff_day|Speed_miles_pr_hour|trip_duration_min|hour_of_day|pickup_location_name         |PU_Borough|dropoff_location_name|DO_Borough|\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\n|1       |2025-01-01 00:18:38 |2025-01-01 00:26:59  |1              |1.6          |1         |N                 |229         |237         |1           |10.0       |3.5  |0.5    |3.0       |0.0         |1.0                  |18.0        |2.5                 |0.0        |0.0               |4         |4          |11.5               |8.35             |24         |Sutton Place/Turtle Bay North|Manhattan |Upper East Side South|Manhattan |\n|1       |2025-01-01 00:32:40 |2025-01-01 00:35:13  |1              |0.5          |1         |N                 |236         |237         |1           |5.1        |3.5  |0.5    |2.02      |0.0         |1.0                  |12.12       |2.5                 |0.0        |0.0               |4         |4          |11.76              |2.55             |24         |Upper East Side North        |Manhattan |Upper East Side South|Manhattan |\n|1       |2025-01-01 00:44:04 |2025-01-01 00:46:01  |1              |0.6          |1         |N                 |141         |141         |1           |5.1        |3.5  |0.5    |2.0       |0.0         |1.0                  |12.1        |2.5                 |0.0        |0.0               |4         |4          |18.46              |1.95             |24         |Lenox Hill West              |Manhattan |Lenox Hill West      |Manhattan |\n+--------+--------------------+---------------------+---------------+-------------+----------+------------------+------------+------------+------------+-----------+-----+-------+----------+------------+---------------------+------------+--------------------+-----------+------------------+----------+-----------+-------------------+-----------------+-----------+-----------------------------+----------+---------------------+----------+\n\n\u001b[1m\u001b[34mdfWithLocationNames\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [VendorID: int, tpep_pickup_datetime: timestamp_ntz ... 27 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=6"},{"jobUrl":"http://localhost:4040/jobs/job?id=7"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219550_1998549770","id":"paragraph_1760926606023_929837040","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:10:55+0000","dateFinished":"2025-10-20T12:11:00+0000","status":"FINISHED"},{"text":"%spark\ndfWithLocationNames.printSchema()","user":"anonymous","dateUpdated":"2025-10-20T12:10:42+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- VendorID: integer (nullable = true)\n |-- tpep_pickup_datetime: timestamp_ntz (nullable = true)\n |-- tpep_dropoff_datetime: timestamp_ntz (nullable = true)\n |-- passenger_count: long (nullable = true)\n |-- trip_distance: double (nullable = true)\n |-- RatecodeID: long (nullable = true)\n |-- store_and_fwd_flag: string (nullable = true)\n |-- PULocationID: integer (nullable = true)\n |-- DOLocationID: integer (nullable = true)\n |-- payment_type: long (nullable = true)\n |-- fare_amount: double (nullable = true)\n |-- extra: double (nullable = true)\n |-- mta_tax: double (nullable = true)\n |-- tip_amount: double (nullable = true)\n |-- tolls_amount: double (nullable = true)\n |-- improvement_surcharge: double (nullable = true)\n |-- total_amount: double (nullable = true)\n |-- congestion_surcharge: double (nullable = true)\n |-- Airport_fee: double (nullable = true)\n |-- cbd_congestion_fee: double (nullable = true)\n |-- pickup_day: integer (nullable = true)\n |-- dropoff_day: integer (nullable = true)\n |-- Speed_miles_pr_hour: double (nullable = true)\n |-- trip_duration_min: double (nullable = true)\n |-- hour_of_day: string (nullable = true)\n |-- pickup_location_name: string (nullable = true)\n |-- PU_Borough: string (nullable = true)\n |-- dropoff_location_name: string (nullable = true)\n |-- DO_Borough: string (nullable = true)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219551_1103519270","id":"paragraph_1760926970524_1039826403","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:11:00+0000","dateFinished":"2025-10-20T12:11:01+0000","status":"FINISHED"},{"text":"%spark\nval out = dfWithLocationNames\n\t.withColumn(\"pickup_date\", to_date(col(\"tpep_pickup_datetime\")))\n\t.withColumn(\"trip_ts\", col(\"tpep_pickup_datetime\").cast(\"timestamp\"))\n\t.withColumn(\"passenger_count\", col(\"passenger_count\").cast(\"int\"))\n\t.withColumn(\"ratecodeid\", col(\"RatecodeID\").cast(\"int\"))\n\t.withColumn(\"payment_type\", col(\"payment_type\").cast(\"int\"))\n\t.withColumn(\"vendorid\", col(\"VendorID\"))\n\t.withColumn(\"pulocationid\", col(\"PULocationID\"))\n\t.withColumn(\"dolocationid\", col(\"DOLocationID\"))\n\t.withColumn(\"airport_fee\", col(\"Airport_fee\"))\n\t.withColumn(\"speed_miles_pr_hour\", col(\"Speed_miles_pr_hour\"))\n\t.withColumn(\"pu_borough\", col(\"PU_Borough\"))\n\t.withColumn(\"do_borough\", col(\"DO_Borough\"))\n\t.select(\n\t\tcol(\"pickup_date\"),\n\t\tcol(\"trip_ts\"),\n\t\tcol(\"pu_borough\"),\n\t\tcol(\"airport_fee\"),\n\t\tcol(\"cbd_congestion_fee\"),\n\t\tcol(\"congestion_surcharge\"),\n\t\tcol(\"do_borough\"),\n\t\tcol(\"dolocationid\"),\n\t\tcol(\"dropoff_day\"),\n\t\tcol(\"dropoff_location_name\"),\n\t\tcol(\"extra\"),\n\t\tcol(\"fare_amount\"),\n\t\tcol(\"hour_of_day\"),\n\t\tcol(\"improvement_surcharge\"),\n\t\tcol(\"mta_tax\"),\n\t\tcol(\"passenger_count\"),\n\t\tcol(\"payment_type\"),\n\t\tcol(\"pickup_day\"),\n\t\tcol(\"pickup_location_name\"),\n\t\tcol(\"pulocationid\"),\n\t\tcol(\"ratecodeid\"),\n\t\tcol(\"speed_miles_pr_hour\"),\n\t\tcol(\"store_and_fwd_flag\"),\n\t\tcol(\"tip_amount\"),\n\t\tcol(\"tolls_amount\"),\n\t\tcol(\"total_amount\"),\n\t\tcol(\"trip_distance\"),\n\t\tcol(\"trip_duration_min\"),\n\t\tcol(\"vendorid\")\n\t\t)\n\nout.show(truncate = false)","user":"anonymous","dateUpdated":"2025-10-20T12:14:18+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-------------------+----------+-----------+------------------+--------------------+----------+------------+-----------+---------------------+-----+-----------+-----------+---------------------+-------+---------------+------------+----------+-----------------------------+------------+----------+-------------------+------------------+----------+------------+------------+-------------+-----------------+--------+\n|pickup_date|trip_ts            |pu_borough|airport_fee|cbd_congestion_fee|congestion_surcharge|do_borough|dolocationid|dropoff_day|dropoff_location_name|extra|fare_amount|hour_of_day|improvement_surcharge|mta_tax|passenger_count|payment_type|pickup_day|pickup_location_name         |pulocationid|ratecodeid|speed_miles_pr_hour|store_and_fwd_flag|tip_amount|tolls_amount|total_amount|trip_distance|trip_duration_min|vendorid|\n+-----------+-------------------+----------+-----------+------------------+--------------------+----------+------------+-----------+---------------------+-----+-----------+-----------+---------------------+-------+---------------+------------+----------+-----------------------------+------------+----------+-------------------+------------------+----------+------------+------------+-------------+-----------------+--------+\n|2025-01-01 |2025-01-01 00:18:38|Manhattan |0.0        |0.0               |2.5                 |Manhattan |237         |4          |Upper East Side South|3.5  |10.0       |24         |1.0                  |0.5    |1              |1           |4         |Sutton Place/Turtle Bay North|229         |1         |11.5               |N                 |3.0       |0.0         |18.0        |1.6          |8.35             |1       |\n|2025-01-01 |2025-01-01 00:32:40|Manhattan |0.0        |0.0               |2.5                 |Manhattan |237         |4          |Upper East Side South|3.5  |5.1        |24         |1.0                  |0.5    |1              |1           |4         |Upper East Side North        |236         |1         |11.76              |N                 |2.02      |0.0         |12.12       |0.5          |2.55             |1       |\n|2025-01-01 |2025-01-01 00:44:04|Manhattan |0.0        |0.0               |2.5                 |Manhattan |141         |4          |Lenox Hill West      |3.5  |5.1        |24         |1.0                  |0.5    |1              |1           |4         |Lenox Hill West              |141         |1         |18.46              |N                 |2.0       |0.0         |12.1        |0.6          |1.95             |1       |\n+-----------+-------------------+----------+-----------+------------------+--------------------+----------+------------+-----------+---------------------+-----+-----------+-----------+---------------------+-------+---------------+------------+----------+-----------------------------+------------+----------+-------------------+------------------+----------+------------+------------+-------------+-----------------+--------+\n\n\u001b[1m\u001b[34mout\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pickup_date: date, trip_ts: timestamp ... 27 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=8"},{"jobUrl":"http://localhost:4040/jobs/job?id=9"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219551_702334736","id":"paragraph_1760927299480_593688626","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:14:18+0000","dateFinished":"2025-10-20T12:14:23+0000","status":"FINISHED"},{"text":"%cassandra\nSELECT keyspace_name FROM system_schema.keyspaces;\n","user":"anonymous","dateUpdated":"2025-10-20T12:12:49+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"keyspace_name\nsystem_auth\nsystem_schema\nsystem_distributed\nsystem\nsystem_traces\nmock_tlc_ks\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962310257_1109092429","id":"paragraph_1760962310257_1109092429","dateCreated":"2025-10-20T12:11:50+0000","dateStarted":"2025-10-20T12:12:49+0000","dateFinished":"2025-10-20T12:12:58+0000","status":"FINISHED"},{"text":"%cassandra\nDESCRIBE KEYSPACE mock_tlc_ks;","user":"anonymous","dateUpdated":"2025-10-20T12:13:39+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<br/>\n<br/>\n<nav class=\"navbar navbar-default\">\n    <ul class=\"nav navbar-nav\">\n        \n\n<li role=\"presentation\" class=\"dropdown\">\n    <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <span class=\"text-danger\"><span class=\"glyphicon glyphicon-folder-open\"></span>&nbsp;&nbsp;<strong>mock_tlc_ks</strong></span>\n        <span class=\"text-danger caret\"></span>\n        <ul class=\"dropdown-menu\">\n            \n\n            <li class=\"dropdown-header\"><span class=\"text-primary\">Tables</span></li>\n                            <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#369bcba0-adae-11f0-8e48-0b293a0e2b08\">\n                    <span class=\"text-primary\"><span class=\"glyphicon glyphicon-th-list\"></span>&nbsp;mock_tlc_raw</span>\n                </a>\n            </li>\n                            \n            \n            \n            \n                    </ul>\n    </a>\n</li>\n        <li>\n            <a><strong>DESCRIBE KEYSPACE mock_tlc_ks;</strong></a>\n        </li>\n    </ul>\n    <ul class=\"nav navbar-nav navbar-right\">\n        <li class=\"dropdown\">\n            <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <strong>Legend</strong>\n                <span class=\"caret\"></span>\n            </a>\n            <ul class=\"dropdown-menu\">\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-dashboard text-muted\" aria-hidden=\"true\" ></span>&nbsp;Cluster\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-folder-open text-danger\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Keyspace\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-copyright-mark text-warning\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;UDT\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-th-list text-primary\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Table\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-eye-open text-primary\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Materialized View\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-random text-success\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Function\n                    </a>\n                </li>\n                <li>\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-retweet text-success\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Aggregate\n                    </a>\n                </li>\n                <li role=\"separator\" class=\"divider text-muted\"></li>\n                <li class=\"dropdown-header\"><span class=\"text-primary\">Table icons</span></li>\n                <li class=\"bg-info\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-fullscreen\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Partition Key\n                    </a>\n                </li>\n                <li class=\"bg-warning\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-pushpin\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Static Column\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-sort\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Clustering Column\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-sort-by-attributes\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Clustering Order ASC\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a href=\"#\">\n                        <span class=\"glyphicon glyphicon-sort-by-attributes-alt\" aria-hidden=\"true\" ></span>&nbsp;&nbsp;Clustering Order DESC\n                    </a>\n                </li>\n            </ul>\n        </li>\n        <li>\n            <a href=\"#\"></a>\n        </li>\n    </ul>\n</nav>\n<hr/>\n\n<div class=\"container\">\n    <!-- Keyspace -->\n    \n\n\n<div class=\"row\">\n    <div class=\"col-md-2\"></div>\n    <div class=\"col-md-8 col-offset-md-2\">\n        <div class=\"panel panel-default table-responsive table-bordered\">\n            <table class=\"table\">\n                \n                <caption>\n                    <h4 class=\"text-danger\">\n                        <span class=\"glyphicon glyphicon-folder-open\"></span>&nbsp;&nbsp;mock_tlc_ks\n                    </h4>\n                </caption>\n                                <thead>\n                <tr>\n                    <th class=\"col-md-10\" style=\"text-align:left\">Replication</th>\n                    <th class=\"col-md-2\" style=\"text-align:left\">Durable Writes</th>\n                </tr>\n                </thead>\n                <tbody>\n                    <tr>\n                        <td class=\"col-md-10\" style=\"text-align:left\">{'class' : 'org.apache.cassandra.locator.SimpleStrategy', 'replication_factor' : '1'}</td>\n                        <td class=\"col-md-2\" style=\"text-align:left\">true</td>\n                    </tr>\n                <tbody>\n            </table>\n            <div class=\"panel-footer\">\n                <a data-toggle=\"collapse\" data-target=\"#363bd150-adae-11f0-8e48-0b293a0e2b08_asCQL\" class=\"text-danger\">\n                    <strong>As CQL statement</strong>\n                    <span class=\"caret\"></span>\n                </a>\n                <br/><br/>\n                <div class=\"collapse\" id=\"363bd150-adae-11f0-8e48-0b293a0e2b08_asCQL\">\n                    <pre class=\"well\">CREATE KEYSPACE mock_tlc_ks WITH replication = { \n\t'class' : 'org.apache.cassandra.locator.SimpleStrategy', \n\t'replication_factor': '1' } AND durable_writes = true;</pre>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-2\"></div>\n</div>\n\n    <!-- Tables -->\n    <div class=\"row\"></div>\n    \n\n    <table width=\"100%\">\n        <td><hr /></td>\n        <td style=\"width:1px; padding: 0 10px; white-space: nowrap;\"><strong class=\"text-primary\">Tables</strong></td>\n        <td><hr /></td>\n    </table>\n    <div class=\"row\">\n        <div class=\"panel-group\" role=\"tablist\" aria-multiselectable=\"true\">\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#369bcba0-adae-11f0-8e48-0b293a0e2b08\" aria-expanded=\"false\">\n                            <span class=\"text-primary\">\n                                <span class=\"glyphicon glyphicon-th-list\"></span>&nbsp;mock_tlc_raw\n                            </span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"369bcba0-adae-11f0-8e48-0b293a0e2b08\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        \n\n<div class=\"row\">\n    <div class=\"col-md-2\"></div>\n    <div class=\"col-md-8 col-offset-md-2\">\n        <div class=\"panel panel-default table-responsive table-bordered\">\n            <table class=\"table\">\n                                <thead>\n                    <tr>\n                        <th class=\"col-md-4\" width=\"10%\">Column Type</th>\n                        <th class=\"col-md-4\">Column Name</th>\n                        <th class=\"col-md-4\" style=\"text-align:left\">Data Type</th>\n                    </tr>\n                </thead>\n                <tbody>\n                                            \n\n                    <tr class=\"info\">\n                        <td class=\"col-md-4\" width=\"10%\">\n                            <span class=\"glyphicon glyphicon-fullscreen\" title=\"Partition Key\"></span>\n                        </td>\n                        <td class=\"col-md-4\">pickup_date</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">date</td>\n                    </tr>\n                                                                    \n                    <tr class=\"success\">\n                        <td class=\"col-md-4\" width=\"10%\">\n                            <span class=\"glyphicon glyphicon-sort\" title=\"Clustering Column\"></span>\n                            &nbsp;\n                            <span class=\"glyphicon glyphicon-sort-by-attributes-alt\" title=\"Sort DESC\"></span>\n                        </td>\n                        <td class=\"col-md-4\">trip_ts</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">timestamp</td>\n                    </tr>\n                                                                    \n                    <tr class=\"success\">\n                        <td class=\"col-md-4\" width=\"10%\">\n                            <span class=\"glyphicon glyphicon-sort\" title=\"Clustering Column\"></span>\n                            &nbsp;\n                            <span class=\"glyphicon glyphicon-sort-by-attributes\" title=\"Sort ASC\"></span>\n                        </td>\n                        <td class=\"col-md-4\">pu_borough</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">airport_fee</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">cbd_congestion_fee</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">congestion_surcharge</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">do_borough</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">dolocationid</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">dropoff_day</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">dropoff_location_name</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">extra</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">fare_amount</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">hour_of_day</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">improvement_surcharge</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">mta_tax</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">passenger_count</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">payment_type</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">pickup_day</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">pickup_location_name</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">pulocationid</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">ratecodeid</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">speed_miles_pr_hour</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">store_and_fwd_flag</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">text</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">tip_amount</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">tolls_amount</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">total_amount</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">trip_distance</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">trip_duration_min</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">double</td>\n                    </tr>\n                                                                    \n                    <tr>\n                        <td class=\"col-md-4\" width=\"10%\"></td>\n                        <td class=\"col-md-4\">vendorid</td>\n                        <td class=\"col-md-4\" style=\"text-align:left\">int</td>\n                    </tr>\n                                                            </tbody>\n            </table>\n            <div class=\"panel-footer\">\n                <a data-toggle=\"collapse\" data-target=\"#369f4e10-adae-11f0-8e48-0b293a0e2b08_asCQL\" class=\"text-primary\">\n                    <strong>As CQL statement</strong>\n                    <span class=\"caret\"></span>\n                </a>\n                <br/><br/>\n                <div class=\"collapse\" id=\"369f4e10-adae-11f0-8e48-0b293a0e2b08_asCQL\">\n                    <pre class=\"well\">CREATE TABLE mock_tlc_ks.mock_tlc_raw (\n    pickup_date date,\n    trip_ts timestamp,\n    pu_borough text,\n    airport_fee double,\n    cbd_congestion_fee double,\n    congestion_surcharge double,\n    do_borough text,\n    dolocationid int,\n    dropoff_day int,\n    dropoff_location_name text,\n    extra double,\n    fare_amount double,\n    hour_of_day text,\n    improvement_surcharge double,\n    mta_tax double,\n    passenger_count int,\n    payment_type int,\n    pickup_day int,\n    pickup_location_name text,\n    pulocationid int,\n    ratecodeid int,\n    speed_miles_pr_hour double,\n    store_and_fwd_flag text,\n    tip_amount double,\n    tolls_amount double,\n    total_amount double,\n    trip_distance double,\n    trip_duration_min double,\n    vendorid int,\n    PRIMARY KEY (pickup_date, trip_ts, pu_borough)\n) WITH CLUSTERING ORDER BY (trip_ts DESC, pu_borough ASC)\n    AND additional_write_policy = '99p'\n    AND bloom_filter_fp_chance = 0.01\n    AND caching = {'keys':'ALL','rows_per_partition':'NONE'}\n    AND comment = ''\n    AND compaction = {'class':'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy','max_threshold':'32','min_threshold':'4'}\n    AND compression = {'chunk_length_in_kb':'16','class':'org.apache.cassandra.io.compress.LZ4Compressor'}\n    AND crc_check_chance = 1.0\n    AND default_time_to_live = 0\n    AND extensions = {}\n    AND gc_grace_seconds = 864000\n    AND max_index_interval = 2048\n    AND memtable_flush_period_in_ms = 0\n    AND min_index_interval = 128\n    AND read_repair = 'BLOCKING'\n    AND speculative_retry = '99p';</pre>\n                </div>\n            </div>\n        </div>\n            </div>\n    <div class=\"col-md-2\"></div>\n</div>\n                    </div>\n                 </div>\n            </div>\n            \n        </div>\n    </div>\n    \n    \n    \n    \n    \n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962374876_1864027112","id":"paragraph_1760962374876_1864027112","dateCreated":"2025-10-20T12:12:54+0000","dateStarted":"2025-10-20T12:13:39+0000","dateFinished":"2025-10-20T12:13:43+0000","status":"FINISHED"},{"text":"%cassandra\nSELECT cluster_name, data_center FROM system.local;","user":"anonymous","dateUpdated":"2025-10-20T12:14:41+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cluster_name\tdata_center\ndemo-cluster\tdatacenter1\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962395122_674018314","id":"paragraph_1760962395122_674018314","dateCreated":"2025-10-20T12:13:15+0000","dateStarted":"2025-10-20T12:14:41+0000","dateFinished":"2025-10-20T12:14:41+0000","status":"FINISHED"},{"text":"%cassandra\nCREATE KEYSPACE mock_tlc_ks\nWITH REPLICATION = {\n  'class': 'SimpleStrategy',\n  'replication_factor': 1\n};\n","user":"anonymous","dateUpdated":"2025-10-20T12:10:19+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n\n\n\n\n<div class=\"container\">\n<div class=\"row\">\n  <h5>No Result &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n    <a role=\"button\" data-toggle=\"collapse\" data-target=\"#305fc9a5-51df-46e0-8b11-1698b856d1ab\" aria-expanded=\"false\">\n      <span class=\"text-info\"><strong>Last query execution info</strong></span>\n    </a>\n  </h5>\n</div>\n<div class=\"panel panel-default\">\n  <div id=\"305fc9a5-51df-46e0-8b11-1698b856d1ab\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n    <div class=\"panel-body\">\n      <div class=\"row\">\n        <div class=\"col-md-3\"></div>\n        <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th>Information</th>\n                <th style=\"text-align:left\">Value</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td>Statement</td>\n                <td style=\"text-align:left\">CREATE KEYSPACE mock_tlc_ks\nWITH REPLICATION = {\n  'class': 'SimpleStrategy',\n  'replication_factor': 1\n};</td>\n              </tr>\n              <tr>\n                <td>Tried Hosts</td>\n                <td style=\"text-align:left\">cassandra-2:9042</td>\n              </tr>\n              <tr>\n                <td>Queried Hosts</td>\n                <td style=\"text-align:left\">cassandra-2:9042</td>\n              </tr>\n              <tr>\n                <td>Schema in Agreement</td>\n                <td style=\"text-align:left\">true</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219552_1777426696","id":"paragraph_1760926621454_871284068","dateCreated":"2025-10-20T12:10:19+0000","status":"READY"},{"text":"%cassandra\nUSE mock_tlc_ks;\n\nCREATE TABLE mock_tlc_raw (\n  pickup_date date,\n  trip_ts timestamp,\n  VendorID int,\n  tpep_pickup_datetime timestamp,\n  tpep_dropoff_datetime timestamp,\n  passenger_count int,\n  trip_distance double,\n  RatecodeID int,\n  store_and_fwd_flag text,\n  PULocationID int,\n  DOLocationID int,\n  payment_type int,\n  fare_amount double,\n  extra double,\n  mta_tax double,\n  tip_amount double,\n  tolls_amount double,\n  improvement_surcharge double,\n  total_amount double,\n  congestion_surcharge double,\n  Airport_fee double,\n  cbd_congestion_fee double,\n  pickup_day int,\n  dropoff_day int,\n  Speed_miles_pr_hour double,\n  trip_duration_min double,\n  hour_of_day text,\n  pickup_location_name text,\n  PU_Borough text,\n  dropoff_location_name text,\n  DO_Borough text,\n  PRIMARY KEY (pickup_date, trip_ts, PU_Borough)\n) WITH CLUSTERING ORDER BY (trip_ts DESC);\n","user":"anonymous","dateUpdated":"2025-10-20T12:10:19+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n\n\n\n\n<div class=\"container\">\n<div class=\"row\">\n  <h5>No Result &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n    <a role=\"button\" data-toggle=\"collapse\" data-target=\"#dd154d97-3f16-4875-afe0-91ca87e4ba14\" aria-expanded=\"false\">\n      <span class=\"text-info\"><strong>Last query execution info</strong></span>\n    </a>\n  </h5>\n</div>\n<div class=\"panel panel-default\">\n  <div id=\"dd154d97-3f16-4875-afe0-91ca87e4ba14\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n    <div class=\"panel-body\">\n      <div class=\"row\">\n        <div class=\"col-md-3\"></div>\n        <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n          <table class=\"table\">\n            <thead>\n              <tr>\n                <th>Information</th>\n                <th style=\"text-align:left\">Value</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td>Statement</td>\n                <td style=\"text-align:left\">CREATE TABLE mock_tlc_raw (\n  pickup_date date,\n  trip_ts timestamp,\n  VendorID int,\n  tpep_pickup_datetime timestamp,\n  tpep_dropoff_datetime timestamp,\n  passenger_count int,\n  trip_distance double,\n  RatecodeID int,\n  store_and_fwd_flag text,\n  PULocationID int,\n  DOLocationID int,\n  payment_type int,\n  fare_amount double,\n  extra double,\n  mta_tax double,\n  tip_amount double,\n  tolls_amount double,\n  improvement_surcharge double,\n  total_amount double,\n  congestion_surcharge double,\n  Airport_fee double,\n  cbd_congestion_fee double,\n  pickup_day int,\n  dropoff_day int,\n  Speed_miles_pr_hour double,\n  trip_duration_min double,\n  hour_of_day text,\n  pickup_location_name text,\n  PU_Borough text,\n  dropoff_location_name text,\n  DO_Borough text,\n  PRIMARY KEY (pickup_date, trip_ts, PU_Borough)\n) WITH CLUSTERING ORDER BY (trip_ts DESC);</td>\n              </tr>\n              <tr>\n                <td>Tried Hosts</td>\n                <td style=\"text-align:left\">cassandra-seed:9042</td>\n              </tr>\n              <tr>\n                <td>Queried Hosts</td>\n                <td style=\"text-align:left\">cassandra-seed:9042</td>\n              </tr>\n              <tr>\n                <td>Schema in Agreement</td>\n                <td style=\"text-align:left\">true</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219554_817519508","id":"paragraph_1760926835851_1891092026","dateCreated":"2025-10-20T12:10:19+0000","status":"READY"},{"text":"%spark\nout.write\n  .format(\"org.apache.spark.sql.cassandra\")\n  .options(Map(\"keyspace\" -> \"mock_tlc_ks\", \"table\" -> \"mock_tlc_raw\"))\n  .mode(\"append\")\n  .save()","user":"anonymous","dateUpdated":"2025-10-20T12:14:56+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://localhost:4040/jobs/job?id=10"},{"jobUrl":"http://localhost:4040/jobs/job?id=11"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219555_566687141","id":"paragraph_1760928016445_953503717","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:14:56+0000","dateFinished":"2025-10-20T12:15:13+0000","status":"FINISHED"},{"text":"%cassandra \nUSE mock_tlc_ks;\n\nSELECT * FROM mock_tlc_raw;","user":"anonymous","dateUpdated":"2025-10-20T12:15:18+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"pickup_date\ttrip_ts\tpu_borough\tairport_fee\tcbd_congestion_fee\tcongestion_surcharge\tdo_borough\tdolocationid\tdropoff_day\tdropoff_location_name\textra\tfare_amount\thour_of_day\timprovement_surcharge\tmta_tax\tpassenger_count\tpayment_type\tpickup_day\tpickup_location_name\tpulocationid\tratecodeid\tspeed_miles_pr_hour\tstore_and_fwd_flag\ttip_amount\ttolls_amount\ttotal_amount\ttrip_distance\ttrip_duration_min\tvendorid\n2025-01-01\t2025-01-01T00:44:04.000Z\tManhattan\t0\t0\t2.5\tManhattan\t141\t4\tLenox Hill West\t3.5\t5.1\t24\t1\t0.5\t1\t1\t4\tLenox Hill West\t141\t1\t18.46\tN\t2\t0\t12.1\t0.6\t1.95\t1\n2025-01-01\t2025-01-01T00:32:40.000Z\tManhattan\t0\t0\t2.5\tManhattan\t237\t4\tUpper East Side South\t3.5\t5.1\t24\t1\t0.5\t1\t1\t4\tUpper East Side North\t236\t1\t11.76\tN\t2.02\t0\t12.12\t0.5\t2.55\t1\n2025-01-01\t2025-01-01T00:18:38.000Z\tManhattan\t0\t0\t2.5\tManhattan\t237\t4\tUpper East Side South\t3.5\t10\t24\t1\t0.5\t1\t1\t4\tSutton Place/Turtle Bay North\t229\t1\t11.5\tN\t3\t0\t18\t1.6\t8.35\t1\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962219556_294455737","id":"paragraph_1760928053392_1478316005","dateCreated":"2025-10-20T12:10:19+0000","dateStarted":"2025-10-20T12:15:18+0000","dateFinished":"2025-10-20T12:15:18+0000","status":"FINISHED"},{"text":"%cassandra\n","user":"anonymous","dateUpdated":"2025-10-20T12:15:18+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1760962518412_1127083764","id":"paragraph_1760962518412_1127083764","dateCreated":"2025-10-20T12:15:18+0000","status":"READY"}],"name":"mock_TLC_CQL","id":"2MAK1WGBE","defaultInterpreterGroup":"spark","version":"0.12.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/mock_TLC_CQL"}